import { Unit_instance1fbcbse1fwigr as Unit_instance } from '../../../../../../kotlin-kotlin-stdlib/kotlin/Unit.mjs';
import {
  toString1pkumu07cwy4m as toString,
  getStringHashCode26igk1bx568vk as getStringHashCode,
  hashCodeq5arwsb9dgti as hashCode,
  equals2au1ep9vhcato as equals,
  getBooleanHashCode1bbj3u6b3v0a7 as getBooleanHashCode,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/coreRuntime.mjs';
import {
  THROW_CCE2g6jy02ryeudk as THROW_CCE,
  ensureNotNull1e947j3ixpazm as ensureNotNull,
  noWhenBranchMatchedException2a6r7ubxgky5j as noWhenBranchMatchedException,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/hacks.mjs';
import {
  initMetadataForClassbxx6q50dy2s7 as initMetadataForClass,
  initMetadataForLambda3af3he42mmnh as initMetadataForLambda,
  initMetadataForCompanion1wyw17z38v6ac as initMetadataForCompanion,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/metadataUtils.mjs';
import { VOID3gxj6tk5isa35 as VOID } from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/void.mjs';
import { LinkedHashMap1zhqxkxv3xnkl as LinkedHashMap } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/LinkedHashMap.mjs';
import {
  Companion_getInstance3vz87v4c01z2t as Companion_getInstance,
  toDuration7gy6v749ektt as toDuration,
  Duration5ynfiptaqcrg as Duration,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/time/Duration.mjs';
import { DurationUnit_MINUTES_getInstancejlptjvjgjkm8 as DurationUnit_MINUTES_getInstance } from '../../../../../../kotlin-kotlin-stdlib/kotlin/time/DurationUnitJs.mjs';
import { ArrayList3it5z8td81qkl as ArrayList } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/ArrayListJs.mjs';
import { RouteType_BUS_getInstance1q03qahihhdox as RouteType_BUS_getInstance } from './RouteType.mjs';
import {
  take3onnpy6q7ctcz as take,
  toSet2orjxp16sotqu as toSet,
  firstOrNull1982767dljvdy as firstOrNull,
  first58ocm7j58k3q as first,
  sortedWith2csnbbb21k0lg as sortedWith,
  plus310ted5e4i90h as plus,
  distinct10qe1scfdvu5k as distinct,
  last1vo29oleiqj36 as last,
  firstOrNullf6vlo6vdgu1e as firstOrNull_0,
  singleOrNull21olsob387p54 as singleOrNull,
  minjeab1ybpajdx as min,
  intersect7qttw6wlmz1n as intersect,
  toList3jhuyej2anx2q as toList,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/_Collections.mjs';
import {
  Paire9pteg33gng7 as Pair,
  to2cs3ny02qtbcb as to,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/Tuples.mjs';
import { LinkedHashSet2tkztfx86kyx2 as LinkedHashSet } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/LinkedHashSet.mjs';
import { addAll1k27qatfgp3k5 as addAll } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/MutableCollections.mjs';
import { toString30pk9tzaqopn as toString_0 } from '../../../../../../kotlin-kotlin-stdlib/kotlin/Library.mjs';
import { collectionSizeOrDefault36dulx8yinfqm as collectionSizeOrDefault } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Iterables.mjs';
import { emptySetcxexqki71qfa as emptySet } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Sets.mjs';
import {
  Companion_getInstance3d66w2y14ekyi as Companion_getInstance_0,
  discardTrackChangesAtCRCoregy68x8glll3u as discardTrackChangesAtCRCore,
} from './Alert.mjs';
import {
  AlertSignificance_Major_getInstance8pdy9s33p31v as AlertSignificance_Major_getInstance,
  AlertSignificance_Accessibility_getInstancec2xro2s82n06 as AlertSignificance_Accessibility_getInstance,
  AlertSignificance_Minor_getInstance1p7hf5pf8k8bq as AlertSignificance_Minor_getInstance,
  AlertSignificance_Secondary_getInstance3jci293j5swh0 as AlertSignificance_Secondary_getInstance,
} from './AlertSignificance.mjs';
import {
  toMap1vec9topfei08 as toMap,
  emptyMapr06gerzljqtm as emptyMap,
  plus2m1vv33moko5t as plus_0,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Maps.mjs';
import {
  Some1vxe3j1x21foa as Some,
  Disruption3h4mahuvj55iw as Disruption,
  Companion_instanceldwplc0fr9g7 as Companion_instance,
  NoTrips29kau07klwuoz as NoTrips,
  PredictionsUnavailable_getInstance37y3wnzovglyc as PredictionsUnavailable_getInstance,
  SecondaryAlert1frcy9kcqjdqc as SecondaryAlert,
  Loading_getInstanceu70orl848nij as Loading_getInstance,
} from './UpcomingFormat.mjs';
import {
  BranchRow1mm74bvnxbsaf as BranchRow,
  Branched1ipw2yg7vafq5 as Branched,
  Singleb6svork69pg4 as Single,
} from './LeafFormat.mjs';
import {
  Collection1k04j3hzsbod0 as Collection,
  KtMap140uvy3s5zad8 as KtMap,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Collections.mjs';
import { isInterface3d6p8outrmvmk as isInterface } from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/typeCheckUtils.mjs';
import { emptyList1g2z5xcrvp2zy as emptyList } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/CollectionsKt.mjs';
import { FunctionAdapter3lcrrz3moet5b as FunctionAdapter } from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/FunctionAdapter.mjs';
import { Comparator2b3maoeh98xtg as Comparator } from '../../../../../../kotlin-kotlin-stdlib/kotlin/ComparatorJs.mjs';
import {
  NoSuchElementException679xzhnp5bpj as NoSuchElementException,
  IllegalStateExceptionkoljg5n0nrlr as IllegalStateException,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/exceptions.mjs';
import { compareTo3ankvs086tmwq as compareTo } from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/compareTo.mjs';
import { compareValues1n2ayl87ihzfk as compareValues } from '../../../../../../kotlin-kotlin-stdlib/kotlin/comparisons/Comparisons.mjs';
import { CoroutineImpl2sn3kjnwmfr10 as CoroutineImpl } from '../../../../../../kotlin-kotlin-stdlib/kotlin/coroutines/CoroutineImpl.mjs';
import { CoroutineScopefcb5f5dwqcas as CoroutineScope } from '../../../../../../kotlinx-coroutines-core/kotlinx/coroutines/CoroutineScope.mjs';
import { AlertsStreamDataResponse12y031ndw7qai as AlertsStreamDataResponse } from './response/AlertsStreamDataResponse.mjs';
import {
  mapCapacity1h45rc3eh9p2l as mapCapacity,
  listOfvhqybd2zx248 as listOf,
  setOf1u3mizs95ngxo as setOf,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/collectionJs.mjs';
import { coerceAtLeast2bkz8m9ik7hep as coerceAtLeast } from '../../../../../../kotlin-kotlin-stdlib/kotlin/ranges/_Ranges.mjs';
import { startsWith26w8qjqapeeq6 as startsWith } from '../../../../../../kotlin-kotlin-stdlib/kotlin/text/stringsCode.mjs';
import {
  Typicality_Typical_getInstance1vjbpi9hmbchb as Typicality_Typical_getInstance,
  Companion_getInstance3gttzdaxvs8n9 as Companion_getInstance_1,
} from './RoutePattern.mjs';
import { Enum3alwj03lh1n41 as Enum } from '../../../../../../kotlin-kotlin-stdlib/kotlin/Enum.mjs';
import {
  Context_NearbyTransit_getInstancec1vh1rynbge6 as Context_NearbyTransit_getInstance,
  Context_StopDetailsFiltered_getInstance25czqftqg9euj as Context_StopDetailsFiltered_getInstance,
  Context_StopDetailsUnfiltered_getInstancecjvly3zms9ub as Context_StopDetailsUnfiltered_getInstance,
} from './TripInstantDisplay.mjs';
import {
  withFormat312p97ewmp5ey as withFormat,
  Companion_instance3rl60mnp81ynu as Companion_instance_0,
  isArrivalOnly1pdrlf49c0z93 as isArrivalOnly,
} from './UpcomingTrip.mjs';
import { Companion_getInstance20mcswkvz9maw as Companion_getInstance_2 } from './MapStopRoute.mjs';
import { StopAlertState_Issue_getInstance5397xi6h7elu as StopAlertState_Issue_getInstance } from './AlertAssociatedStop.mjs';
import { Companion_getInstance2e2qcwwp7c5i2 as Companion_getInstance_3 } from './Direction.mjs';
import { withContexte657h72vdbqn as withContext } from '../../../../../../kotlinx-coroutines-core/kotlinx/coroutines/Builders.common.mjs';
import { Dispatchers_getInstanceitgtkvqfcnx3 as Dispatchers_getInstance } from '../../../../../../kotlinx-coroutines-core/kotlinx/coroutines/Dispatchers.mjs';
import { Companion_getInstance2quiddekkvdc7 as Companion_getInstance_4 } from './Stop.mjs';
import { PatternSorting_instance3rd10z8olpxdf as PatternSorting_instance } from './PatternSorting.mjs';
//region block: imports
var imul = Math.imul;
//endregion
//region block: pre-declaration
//endregion
var com_mbta_tid_mbta_app_model_RouteCardData_RouteStopData$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_Leaf$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_LineOrRoute_Line$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_LineOrRoute_Route$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_LineOrRoute$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_HierarchyPath$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_ListBuilder$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_Builder$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_RouteStopDataBuilder$stable;
var com_mbta_tid_mbta_app_model_RouteCardData_LeafBuilder$stable;
var com_mbta_tid_mbta_app_model_RouteCardData$stable;
var Context_NearbyTransit_instance;
var Context_StopDetailsFiltered_instance;
var Context_StopDetailsUnfiltered_instance;
var Context_Favorites_instance;
var Context_entriesInitialized;
function Context_initEntries() {
  if (Context_entriesInitialized)
    return Unit_instance;
  Context_entriesInitialized = true;
  Context_NearbyTransit_instance = new (Context())('NearbyTransit', 0);
  Context_StopDetailsFiltered_instance = new (Context())('StopDetailsFiltered', 1);
  Context_StopDetailsUnfiltered_instance = new (Context())('StopDetailsUnfiltered', 2);
  Context_Favorites_instance = new (Context())('Favorites', 3);
}
var PotentialServiceClass;
function PotentialService() {
  if (PotentialServiceClass === VOID) {
    class $ {
      constructor(routeId, headsign, routePatternIds) {
        this.d97_1 = routeId;
        this.e97_1 = headsign;
        this.f97_1 = routePatternIds;
      }
      dh() {
        return this.e97_1;
      }
      g97() {
        return this.f97_1;
      }
      toString() {
        return 'PotentialService(routeId=' + this.d97_1 + ', headsign=' + this.e97_1 + ', routePatternIds=' + toString(this.f97_1) + ')';
      }
      hashCode() {
        var result = getStringHashCode(this.d97_1);
        result = imul(result, 31) + getStringHashCode(this.e97_1) | 0;
        result = imul(result, 31) + hashCode(this.f97_1) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof PotentialService()))
          return false;
        var tmp0_other_with_cast = other instanceof PotentialService() ? other : THROW_CCE();
        if (!(this.d97_1 === tmp0_other_with_cast.d97_1))
          return false;
        if (!(this.e97_1 === tmp0_other_with_cast.e97_1))
          return false;
        if (!equals(this.f97_1, tmp0_other_with_cast.f97_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'PotentialService');
    PotentialServiceClass = $;
  }
  return PotentialServiceClass;
}
function potentialService($this, now, representativeRoute, globalData, context) {
  // Inline function 'kotlin.collections.mutableMapOf' call
  var potentialService = LinkedHashMap().sc();
  // Inline function 'kotlin.time.Companion.minutes' call
  Companion_getInstance();
  var tmp$ret$1 = toDuration(120, DurationUnit_MINUTES_getInstance());
  var cutoffTime = now.ov(tmp$ret$1);
  // Inline function 'kotlin.collections.filter' call
  var tmp0 = $this.e8t_1;
  // Inline function 'kotlin.collections.filterTo' call
  var destination = ArrayList().g1();
  var _iterator__ex2g4s = tmp0.x();
  while (_iterator__ex2g4s.y()) {
    var element = _iterator__ex2g4s.z();
    if (element.h97(now, cutoffTime)) {
      destination.i(element);
    }
  }
  var tripsUpcoming = destination;
  var isBus = representativeRoute.p8r_1.equals(RouteType_BUS_getInstance());
  var tripsToConsider = isBus && !context.equals(Context_StopDetailsFiltered_getInstance_0()) ? take(tripsUpcoming, 2) : tripsUpcoming;
  var _iterator__ex2g4s_0 = tripsToConsider.x();
  while (_iterator__ex2g4s_0.y()) {
    var trip = _iterator__ex2g4s_0.z();
    if (trip.h97(now, cutoffTime)) {
      // Inline function 'kotlin.collections.getOrPut' call
      var key = new (Pair())(trip.v8t_1.r8t_1, trip.i97());
      var value = potentialService.j3(key);
      var tmp;
      if (value == null) {
        // Inline function 'kotlin.collections.mutableSetOf' call
        var answer = LinkedHashSet().f1();
        potentialService.t3(key, answer);
        tmp = answer;
      } else {
        tmp = value;
      }
      var existingPatterns = tmp;
      if (!(trip.v8t_1.s8t_1 == null)) {
        existingPatterns.i(trip.v8t_1.s8t_1);
      }
    }
  }
  if (!isBus) {
    var _iterator__ex2g4s_1 = $this.c8t_1.x();
    $l$loop: while (_iterator__ex2g4s_1.y()) {
      var routePattern = _iterator__ex2g4s_1.z();
      var tmp_0;
      if (routePattern.j97()) {
        var tmp0_0 = potentialService.l3();
        // Inline function 'kotlin.collections.mutableSetOf' call
        // Inline function 'kotlin.collections.flatMapTo' call
        var destination_0 = LinkedHashSet().f1();
        var _iterator__ex2g4s_2 = tmp0_0.x();
        while (_iterator__ex2g4s_2.y()) {
          var element_0 = _iterator__ex2g4s_2.z();
          var list = element_0;
          addAll(destination_0, list);
        }
        tmp_0 = !destination_0.j1(routePattern.r8z_1);
      } else {
        tmp_0 = false;
      }
      if (tmp_0) {
        var tmp1_safe_receiver = globalData == null ? null : globalData.o8u_1;
        var tmp2_safe_receiver = tmp1_safe_receiver == null ? null : tmp1_safe_receiver.j3(routePattern.w8z_1);
        var tmp3_elvis_lhs = tmp2_safe_receiver == null ? null : tmp2_safe_receiver.q8t_1;
        var tmp_1;
        if (tmp3_elvis_lhs == null) {
          continue $l$loop;
        } else {
          tmp_1 = tmp3_elvis_lhs;
        }
        var headsign = tmp_1;
        // Inline function 'kotlin.collections.getOrPut' call
        var key_0 = new (Pair())(routePattern.x8z_1, headsign);
        var value_0 = potentialService.j3(key_0);
        var tmp_2;
        if (value_0 == null) {
          // Inline function 'kotlin.collections.mutableSetOf' call
          var answer_0 = LinkedHashSet().f1();
          potentialService.t3(key_0, answer_0);
          tmp_2 = answer_0;
        } else {
          tmp_2 = value_0;
        }
        tmp_2.i(routePattern.r8z_1);
      }
    }
  }
  // Inline function 'kotlin.collections.map' call
  // Inline function 'kotlin.collections.mapTo' call
  var destination_1 = ArrayList().w(potentialService.c1());
  // Inline function 'kotlin.collections.iterator' call
  var _iterator__ex2g4s_3 = potentialService.t1().x();
  while (_iterator__ex2g4s_3.y()) {
    var item = _iterator__ex2g4s_3.z();
    // Inline function 'kotlin.collections.component1' call
    var key_1 = item.u1();
    // Inline function 'kotlin.collections.component2' call
    var patternIds = item.v1();
    var tmp$ret$17 = new (PotentialService())(key_1.ah_1, key_1.bh_1, patternIds);
    destination_1.i(tmp$ret$17);
  }
  return toSet(destination_1);
}
var ByHeadsignDataClass;
function ByHeadsignData() {
  if (ByHeadsignDataClass === VOID) {
    class $ {
      constructor(stopIds, routePatterns, hasSchedulesToday, allUpcomingTrips, majorAlert) {
        this.k97_1 = stopIds;
        this.l97_1 = routePatterns;
        this.m97_1 = hasSchedulesToday;
        this.n97_1 = allUpcomingTrips;
        this.o97_1 = majorAlert;
      }
      toString() {
        return 'ByHeadsignData(stopIds=' + toString(this.k97_1) + ', routePatterns=' + toString(this.l97_1) + ', hasSchedulesToday=' + this.m97_1 + ', allUpcomingTrips=' + toString(this.n97_1) + ', majorAlert=' + toString_0(this.o97_1) + ')';
      }
      hashCode() {
        var result = hashCode(this.k97_1);
        result = imul(result, 31) + hashCode(this.l97_1) | 0;
        result = imul(result, 31) + getBooleanHashCode(this.m97_1) | 0;
        result = imul(result, 31) + hashCode(this.n97_1) | 0;
        result = imul(result, 31) + (this.o97_1 == null ? 0 : this.o97_1.hashCode()) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof ByHeadsignData()))
          return false;
        var tmp0_other_with_cast = other instanceof ByHeadsignData() ? other : THROW_CCE();
        if (!equals(this.k97_1, tmp0_other_with_cast.k97_1))
          return false;
        if (!equals(this.l97_1, tmp0_other_with_cast.l97_1))
          return false;
        if (!(this.m97_1 === tmp0_other_with_cast.m97_1))
          return false;
        if (!equals(this.n97_1, tmp0_other_with_cast.n97_1))
          return false;
        if (!equals(this.o97_1, tmp0_other_with_cast.o97_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'ByHeadsignData');
    ByHeadsignDataClass = $;
  }
  return ByHeadsignDataClass;
}
function dataByHeadsign($this, potentialService, globalData) {
  // Inline function 'kotlin.collections.map' call
  // Inline function 'kotlin.collections.mapTo' call
  var destination = ArrayList().w(collectionSizeOrDefault(potentialService, 10));
  var _iterator__ex2g4s = potentialService.x();
  while (_iterator__ex2g4s.y()) {
    var item = _iterator__ex2g4s.z();
    var headsign = item.dh();
    var patternIds = item.g97();
    // Inline function 'kotlin.collections.filter' call
    var tmp0 = $this.c8t_1;
    // Inline function 'kotlin.collections.filterTo' call
    var destination_0 = ArrayList().g1();
    var _iterator__ex2g4s_0 = tmp0.x();
    while (_iterator__ex2g4s_0.y()) {
      var element = _iterator__ex2g4s_0.z();
      if (patternIds.j1(element.r8z_1)) {
        destination_0.i(element);
      }
    }
    var routePatterns = destination_0;
    // Inline function 'kotlin.collections.map' call
    // Inline function 'kotlin.collections.mapTo' call
    var destination_1 = ArrayList().w(collectionSizeOrDefault(routePatterns, 10));
    var _iterator__ex2g4s_1 = routePatterns.x();
    while (_iterator__ex2g4s_1.y()) {
      var item_0 = _iterator__ex2g4s_1.z();
      var tmp$ret$3 = item_0.r8z_1;
      destination_1.i(tmp$ret$3);
    }
    var routePatternIds = toSet(destination_1);
    var tmp;
    if (globalData == null) {
      tmp = null;
    } else {
      // Inline function 'kotlin.let' call
      tmp = Companion_instance_1.r97(routePatterns, globalData, $this.d8t_1);
    }
    // Inline function 'kotlin.collections.orEmpty' call
    var tmp0_elvis_lhs = tmp;
    var stopIds = tmp0_elvis_lhs == null ? emptySet() : tmp0_elvis_lhs;
    var tmp_0 = Companion_getInstance_0();
    // Inline function 'kotlin.collections.filter' call
    var tmp0_0 = $this.f8t_1;
    // Inline function 'kotlin.collections.filterTo' call
    var destination_2 = ArrayList().g1();
    var _iterator__ex2g4s_2 = tmp0_0.x();
    while (_iterator__ex2g4s_2.y()) {
      var element_0 = _iterator__ex2g4s_2.z();
      if (element_0.k8z_1.a4(AlertSignificance_Major_getInstance()) >= 0) {
        destination_2.i(element_0);
      }
    }
    var tmp_1 = destination_2;
    // Inline function 'kotlin.collections.map' call
    // Inline function 'kotlin.collections.mapTo' call
    var destination_3 = ArrayList().w(collectionSizeOrDefault(routePatterns, 10));
    var _iterator__ex2g4s_3 = routePatterns.x();
    while (_iterator__ex2g4s_3.y()) {
      var item_1 = _iterator__ex2g4s_3.z();
      var tmp$ret$12 = item_1.x8z_1;
      destination_3.i(tmp$ret$12);
    }
    var majorAlert = tmp_0.u8y(tmp_1, $this.b8t_1, destination_3, stopIds, null);
    // Inline function 'kotlin.collections.filterKeys' call
    var this_0 = $this.h8t_1;
    var result = LinkedHashMap().sc();
    // Inline function 'kotlin.collections.iterator' call
    var _iterator__ex2g4s_4 = this_0.t1().x();
    while (_iterator__ex2g4s_4.y()) {
      var entry = _iterator__ex2g4s_4.z();
      var it = entry.u1();
      if (routePatternIds.j1(it)) {
        result.t3(entry.u1(), entry.v1());
      }
    }
    var tmp$ret$18;
    $l$block_0: {
      // Inline function 'kotlin.collections.any' call
      if (result.h1()) {
        tmp$ret$18 = false;
        break $l$block_0;
      }
      // Inline function 'kotlin.collections.iterator' call
      var _iterator__ex2g4s_5 = result.t1().x();
      while (_iterator__ex2g4s_5.y()) {
        var element_1 = _iterator__ex2g4s_5.z();
        if (element_1.v1()) {
          tmp$ret$18 = true;
          break $l$block_0;
        }
      }
      tmp$ret$18 = false;
    }
    var tmp_2 = tmp$ret$18;
    // Inline function 'kotlin.collections.filter' call
    var tmp0_1 = $this.e8t_1;
    // Inline function 'kotlin.collections.filterTo' call
    var destination_4 = ArrayList().g1();
    var _iterator__ex2g4s_6 = tmp0_1.x();
    while (_iterator__ex2g4s_6.y()) {
      var element_2 = _iterator__ex2g4s_6.z();
      if (element_2.i97() === headsign) {
        destination_4.i(element_2);
      }
    }
    var tmp$ret$24 = to(headsign, new (ByHeadsignData())(stopIds, routePatterns, tmp_2, destination_4, firstOrNull(majorAlert)));
    destination.i(tmp$ret$24);
  }
  return toMap(destination);
}
function formatForBranchedService($this, potentialService, tripsWithFormat, mapStopRoute, secondaryAlert, globalData, now) {
  var tmp = $this.z8s_1;
  var shouldIncludeRoute = tmp instanceof Line();
  var dataByHeadsign_0 = dataByHeadsign($this, potentialService, globalData);
  // Inline function 'kotlin.collections.partition' call
  var this_0 = dataByHeadsign_0.t1();
  var first_0 = ArrayList().g1();
  var second = ArrayList().g1();
  var _iterator__ex2g4s = this_0.x();
  while (_iterator__ex2g4s.y()) {
    var element = _iterator__ex2g4s.z();
    if (element.v1().o97_1 == null) {
      first_0.i(element);
    } else {
      second.i(element);
    }
  }
  var _destruct__k2r9zo = new (Pair())(first_0, second);
  var nonDisruptedHeadsigns = _destruct__k2r9zo.ch();
  var disruptedHeadsigns = _destruct__k2r9zo.dh();
  if (disruptedHeadsigns.h1()) {
    // Inline function 'kotlin.collections.map' call
    // Inline function 'kotlin.collections.mapTo' call
    var destination = ArrayList().w(collectionSizeOrDefault(tripsWithFormat, 10));
    var _iterator__ex2g4s_0 = tripsWithFormat.x();
    while (_iterator__ex2g4s_0.y()) {
      var item = _iterator__ex2g4s_0.z();
      var trip = item.ch();
      var format = item.dh();
      var tmp_0;
      if (shouldIncludeRoute) {
        tmp_0 = globalData == null ? null : globalData.s97(trip.v8t_1.r8t_1);
      } else {
        tmp_0 = null;
      }
      var route = tmp_0;
      var tmp$ret$2 = new (BranchRow())(route, trip.i97(), Some().m92(format, null));
      destination.i(tmp$ret$2);
    }
    return new (Branched())(destination, secondaryAlert);
  }
  var tmp_1;
  if (nonDisruptedHeadsigns.h1()) {
    // Inline function 'kotlin.collections.map' call
    // Inline function 'kotlin.collections.mapTo' call
    var destination_0 = ArrayList().w(collectionSizeOrDefault(disruptedHeadsigns, 10));
    var _iterator__ex2g4s_1 = disruptedHeadsigns.x();
    while (_iterator__ex2g4s_1.y()) {
      var item_0 = _iterator__ex2g4s_1.z();
      var tmp$ret$5 = item_0.v1().o97_1;
      destination_0.i(tmp$ret$5);
    }
    var tmp$ret$8;
    $l$block_0: {
      // Inline function 'kotlin.collections.all' call
      var tmp_2;
      if (isInterface(destination_0, Collection())) {
        tmp_2 = destination_0.h1();
      } else {
        tmp_2 = false;
      }
      if (tmp_2) {
        tmp$ret$8 = true;
        break $l$block_0;
      }
      var _iterator__ex2g4s_2 = destination_0.x();
      while (_iterator__ex2g4s_2.y()) {
        var element_0 = _iterator__ex2g4s_2.z();
        if (!equals(element_0, first(disruptedHeadsigns).v1().o97_1)) {
          tmp$ret$8 = false;
          break $l$block_0;
        }
      }
      tmp$ret$8 = true;
    }
    tmp_1 = tmp$ret$8;
  } else {
    tmp_1 = false;
  }
  if (tmp_1) {
    return new (Single())(null, null, Disruption().w97(ensureNotNull(first(disruptedHeadsigns).v1().o97_1), mapStopRoute));
  }
  // Inline function 'kotlin.collections.sortedBy' call
  // Inline function 'kotlin.comparisons.compareBy' call
  var tmp_3 = RouteCardData$Leaf$formatForBranchedService$lambda;
  var tmp$ret$10 = new (sam$kotlin_Comparator$0())(tmp_3);
  var tmp$ret$11 = sortedWith(disruptedHeadsigns, tmp$ret$10);
  // Inline function 'kotlin.collections.map' call
  var this_1 = take(tmp$ret$11, 3);
  // Inline function 'kotlin.collections.mapTo' call
  var destination_1 = ArrayList().w(collectionSizeOrDefault(this_1, 10));
  var _iterator__ex2g4s_3 = this_1.x();
  while (_iterator__ex2g4s_3.y()) {
    var item_1 = _iterator__ex2g4s_3.z();
    // Inline function 'kotlin.collections.component1' call
    var headsign = item_1.u1();
    // Inline function 'kotlin.collections.component2' call
    var groupedData = item_1.v1();
    var tmp_4;
    if (shouldIncludeRoute) {
      var tmp_5;
      if (globalData == null) {
        tmp_5 = null;
      } else {
        var tmp1_safe_receiver = firstOrNull(groupedData.l97_1);
        tmp_5 = globalData.s97(tmp1_safe_receiver == null ? null : tmp1_safe_receiver.x8z_1);
      }
      tmp_4 = tmp_5;
    } else {
      tmp_4 = null;
    }
    var route_0 = tmp_4;
    var tmp$ret$14 = new (BranchRow())(route_0, headsign, Disruption().w97(ensureNotNull(groupedData.o97_1), mapStopRoute));
    destination_1.i(tmp$ret$14);
  }
  var disruptedHeadsignBranches = destination_1;
  // Inline function 'kotlin.math.max' call
  var b = 3 - disruptedHeadsignBranches.c1() | 0;
  var remainingRowsToShow = Math.max(1, b);
  // Inline function 'kotlin.collections.map' call
  var this_2 = take(tripsWithFormat, remainingRowsToShow);
  // Inline function 'kotlin.collections.mapTo' call
  var destination_2 = ArrayList().w(collectionSizeOrDefault(this_2, 10));
  var _iterator__ex2g4s_4 = this_2.x();
  while (_iterator__ex2g4s_4.y()) {
    var item_2 = _iterator__ex2g4s_4.z();
    var upcomingTrip = item_2.ch();
    var formatted = item_2.dh();
    var tmp_6;
    if (shouldIncludeRoute) {
      tmp_6 = globalData == null ? null : globalData.s97(upcomingTrip.v8t_1.r8t_1);
    } else {
      tmp_6 = null;
    }
    var route_1 = tmp_6;
    var tmp$ret$18 = new (BranchRow())(route_1, upcomingTrip.v8t_1.q8t_1, Some().m92(formatted, null));
    destination_2.i(tmp$ret$18);
  }
  var upcomingTripBranches = destination_2;
  // Inline function 'kotlin.math.max' call
  var b_0 = remainingRowsToShow - upcomingTripBranches.c1() | 0;
  remainingRowsToShow = Math.max(0, b_0);
  var tmp_7;
  if (remainingRowsToShow > 0) {
    // Inline function 'kotlin.collections.sortedBy' call
    // Inline function 'kotlin.comparisons.compareBy' call
    var tmp_8 = RouteCardData$Leaf$formatForBranchedService$lambda_0;
    var tmp$ret$22 = new (sam$kotlin_Comparator$0())(tmp_8);
    // Inline function 'kotlin.collections.mapNotNull' call
    var tmp0 = sortedWith(nonDisruptedHeadsigns, tmp$ret$22);
    // Inline function 'kotlin.collections.mapNotNullTo' call
    var destination_3 = ArrayList().g1();
    // Inline function 'kotlin.collections.forEach' call
    var _iterator__ex2g4s_5 = tmp0.x();
    while (_iterator__ex2g4s_5.y()) {
      var element_1 = _iterator__ex2g4s_5.z();
      // Inline function 'kotlin.collections.component1' call
      var headsign_0 = element_1.u1();
      // Inline function 'kotlin.collections.component2' call
      var groupedData_0 = element_1.v1();
      var tmp_9;
      if (shouldIncludeRoute) {
        var tmp_10;
        if (globalData == null) {
          tmp_10 = null;
        } else {
          var tmp1_safe_receiver_0 = firstOrNull(groupedData_0.l97_1);
          tmp_10 = globalData.s97(tmp1_safe_receiver_0 == null ? null : tmp1_safe_receiver_0.x8z_1);
        }
        tmp_9 = tmp_10;
      } else {
        tmp_9 = null;
      }
      var route_2 = tmp_9;
      var noTripsFormat = Companion_instance.x97(groupedData_0.n97_1, groupedData_0.m97_1, now);
      var tmp_11;
      if (equals(noTripsFormat, PredictionsUnavailable_getInstance())) {
        tmp_11 = new (BranchRow())(route_2, headsign_0, NoTrips().a98(noTripsFormat, null));
      } else {
        tmp_11 = null;
      }
      var tmp0_safe_receiver = tmp_11;
      if (tmp0_safe_receiver == null)
        null;
      else {
        // Inline function 'kotlin.let' call
        destination_3.i(tmp0_safe_receiver);
      }
    }
    tmp_7 = take(destination_3, remainingRowsToShow);
  } else {
    tmp_7 = emptyList();
  }
  var predictionsUnavailableBranches = tmp_7;
  return new (Branched())(plus(plus(upcomingTripBranches, predictionsUnavailableBranches), disruptedHeadsignBranches), secondaryAlert);
}
function formatForSingleHeadsignService($this, route, headsign, formattedTrips, mapStopRoute, secondaryAlert) {
  var tmp;
  if (!($this.m8t_1 == null)) {
    tmp = Disruption().w97($this.m8t_1, mapStopRoute);
  } else {
    tmp = Some().b98(formattedTrips, secondaryAlert);
  }
  var format = tmp;
  return new (Single())(route, headsign, format);
}
var sam$kotlin_Comparator$0Class;
function sam$kotlin_Comparator$0() {
  if (sam$kotlin_Comparator$0Class === VOID) {
    class $ {
      constructor(function_0) {
        this.c98_1 = function_0;
      }
      al(a, b) {
        return this.c98_1(a, b);
      }
      compare(a, b) {
        return this.al(a, b);
      }
      z4() {
        return this.c98_1;
      }
      equals(other) {
        var tmp;
        if (!(other == null) ? isInterface(other, Comparator()) : false) {
          var tmp_0;
          if (!(other == null) ? isInterface(other, FunctionAdapter()) : false) {
            tmp_0 = equals(this.z4(), other.z4());
          } else {
            tmp_0 = false;
          }
          tmp = tmp_0;
        } else {
          tmp = false;
        }
        return tmp;
      }
      hashCode() {
        return hashCode(this.z4());
      }
    }
    initMetadataForClass($, 'sam$kotlin_Comparator$0', VOID, VOID, [Comparator(), FunctionAdapter()]);
    sam$kotlin_Comparator$0Class = $;
  }
  return sam$kotlin_Comparator$0Class;
}
function RouteCardData$Leaf$formatForBranchedService$lambda(a, b) {
  // Inline function 'kotlin.comparisons.compareValuesBy' call
  // Inline function 'kotlin.collections.minOf' call
  var iterator = a.v1().l97_1.x();
  if (!iterator.y())
    throw NoSuchElementException().m1();
  var minValue = iterator.z().u8z_1;
  while (iterator.y()) {
    var v = iterator.z().u8z_1;
    if (compareTo(minValue, v) > 0) {
      minValue = v;
    }
  }
  var tmp = minValue;
  // Inline function 'kotlin.collections.minOf' call
  var iterator_0 = b.v1().l97_1.x();
  if (!iterator_0.y())
    throw NoSuchElementException().m1();
  var minValue_0 = iterator_0.z().u8z_1;
  while (iterator_0.y()) {
    var v_0 = iterator_0.z().u8z_1;
    if (compareTo(minValue_0, v_0) > 0) {
      minValue_0 = v_0;
    }
  }
  var tmp$ret$7 = minValue_0;
  return compareValues(tmp, tmp$ret$7);
}
function RouteCardData$Leaf$formatForBranchedService$lambda_0(a, b) {
  // Inline function 'kotlin.comparisons.compareValuesBy' call
  // Inline function 'kotlin.collections.minOf' call
  var iterator = a.v1().l97_1.x();
  if (!iterator.y())
    throw NoSuchElementException().m1();
  var minValue = iterator.z().u8z_1;
  while (iterator.y()) {
    var v = iterator.z().u8z_1;
    if (compareTo(minValue, v) > 0) {
      minValue = v;
    }
  }
  var tmp = minValue;
  // Inline function 'kotlin.collections.minOf' call
  var iterator_0 = b.v1().l97_1.x();
  if (!iterator_0.y())
    throw NoSuchElementException().m1();
  var minValue_0 = iterator_0.z().u8z_1;
  while (iterator_0.y()) {
    var v_0 = iterator_0.z().u8z_1;
    if (compareTo(minValue_0, v_0) > 0) {
      minValue_0 = v_0;
    }
  }
  var tmp$ret$7 = minValue_0;
  return compareValues(tmp, tmp$ret$7);
}
var LineClass;
function Line() {
  if (LineClass === VOID) {
    class $ extends LineOrRoute() {
      constructor(line, routes) {
        super();
        this.d98_1 = line;
        this.e98_1 = routes;
      }
      toString() {
        return 'Line(line=' + this.d98_1.toString() + ', routes=' + toString(this.e98_1) + ')';
      }
      hashCode() {
        var result = this.d98_1.hashCode();
        result = imul(result, 31) + hashCode(this.e98_1) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof Line()))
          return false;
        var tmp0_other_with_cast = other instanceof Line() ? other : THROW_CCE();
        if (!this.d98_1.equals(tmp0_other_with_cast.d98_1))
          return false;
        if (!equals(this.e98_1, tmp0_other_with_cast.e98_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'Line');
    LineClass = $;
  }
  return LineClass;
}
var RouteClass;
function Route() {
  if (RouteClass === VOID) {
    class $ extends LineOrRoute() {
      constructor(route) {
        super();
        this.i98_1 = route;
      }
      toString() {
        return 'Route(route=' + this.i98_1.toString() + ')';
      }
      hashCode() {
        return this.i98_1.hashCode();
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof Route()))
          return false;
        var tmp0_other_with_cast = other instanceof Route() ? other : THROW_CCE();
        if (!this.i98_1.equals(tmp0_other_with_cast.i98_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'Route');
    RouteClass = $;
  }
  return RouteClass;
}
var RouteCardData$Companion$routeCardsForStopList$slambdaClass;
function RouteCardData$Companion$routeCardsForStopList$slambda() {
  if (RouteCardData$Companion$routeCardsForStopList$slambdaClass === VOID) {
    class $ extends CoroutineImpl() {
      constructor($predictions, $alerts, $globalData, $context, $now, $schedules, $stopIds, $favorites, $sortByDistanceFrom, resultContinuation, $box) {
        if ($box === VOID)
          $box = {};
        $box.r98_1 = $predictions;
        $box.s98_1 = $alerts;
        $box.t98_1 = $globalData;
        $box.u98_1 = $context;
        $box.v98_1 = $now;
        $box.w98_1 = $schedules;
        $box.x98_1 = $stopIds;
        $box.y98_1 = $favorites;
        $box.z98_1 = $sortByDistanceFrom;
        super(resultContinuation, $box);
      }
      b99($this$withContext, $completion) {
        var tmp = this.y3e($this$withContext, $completion);
        tmp.hd_1 = Unit_instance;
        tmp.id_1 = null;
        return tmp.nd();
      }
      ne(p1, $completion) {
        return this.b99((!(p1 == null) ? isInterface(p1, CoroutineScope()) : false) ? p1 : THROW_CCE(), $completion);
      }
      nd() {
        var suspendResult = this.hd_1;
        $sm: do
          try {
            var tmp = this.fd_1;
            if (tmp === 0) {
              this.gd_1 = 1;
              if (this.r98_1 == null || this.s98_1 == null)
                return null;
              if (this.t98_1 == null)
                return null;
              var tmp_0;
              switch (this.u98_1.x3_1) {
                case 0:
                  Companion_getInstance();
                  tmp_0 = toDuration(120, DurationUnit_MINUTES_getInstance());
                  break;
                case 2:
                  Companion_getInstance();
                  tmp_0 = toDuration(120, DurationUnit_MINUTES_getInstance());
                  break;
                case 1:
                case 3:
                  tmp_0 = null;
                  break;
                default:
                  noWhenBranchMatchedException();
                  break;
              }
              var hideNonTypicalPatternsBeyondNext = tmp_0;
              var tmp_1;
              var tmp_2 = hideNonTypicalPatternsBeyondNext;
              if ((tmp_2 == null ? null : new (Duration())(tmp_2)) == null) {
                tmp_1 = null;
              } else {
                var tmp_3 = hideNonTypicalPatternsBeyondNext;
                var it = (tmp_3 == null ? null : new (Duration())(tmp_3)).xl_1;
                tmp_1 = this.v98_1.ov(it);
              }
              var cutoffTime = tmp_1;
              var allDataLoaded = !(this.w98_1 == null);
              return sort((new (ListBuilder())(allDataLoaded, this.u98_1, this.v98_1)).g99(this.x98_1, this.t98_1, this.u98_1, this.y98_1).h99(this.w98_1, this.r98_1, this.v98_1, this.t98_1).i99(this.v98_1, cutoffTime, this.u98_1, this.t98_1).m99(this.s98_1, this.u98_1.l99(), this.v98_1, this.t98_1).n99(this.z98_1), this.z98_1, this.u98_1);
            } else if (tmp === 1) {
              throw this.id_1;
            }
          } catch ($p) {
            var e = $p;
            throw e;
          }
         while (true);
      }
      y3e($this$withContext, completion) {
        var i = new (RouteCardData$Companion$routeCardsForStopList$slambda())(this.r98_1, this.s98_1, this.t98_1, this.u98_1, this.v98_1, this.w98_1, this.x98_1, this.y98_1, this.z98_1, completion);
        i.a99_1 = $this$withContext;
        return i;
      }
    }
    initMetadataForLambda($, VOID, VOID, [1]);
    RouteCardData$Companion$routeCardsForStopList$slambdaClass = $;
  }
  return RouteCardData$Companion$routeCardsForStopList$slambdaClass;
}
function RouteCardData$Companion$routeCardsForStopList$slambda_0($predictions, $alerts, $globalData, $context, $now, $schedules, $stopIds, $favorites, $sortByDistanceFrom, resultContinuation) {
  var i = new (RouteCardData$Companion$routeCardsForStopList$slambda())($predictions, $alerts, $globalData, $context, $now, $schedules, $stopIds, $favorites, $sortByDistanceFrom, resultContinuation);
  var l = function ($this$withContext, $completion) {
    return i.b99($this$withContext, $completion);
  };
  l.$arity = 1;
  return l;
}
var RouteCardData$Companion$routeCardsForStaticStopList$slambdaClass;
function RouteCardData$Companion$routeCardsForStaticStopList$slambda() {
  if (RouteCardData$Companion$routeCardsForStaticStopList$slambdaClass === VOID) {
    class $ extends CoroutineImpl() {
      constructor($globalData, $context, $now, $stopIds, $favorites, $sortByDistanceFrom, resultContinuation, $box) {
        if ($box === VOID)
          $box = {};
        $box.w99_1 = $globalData;
        $box.x99_1 = $context;
        $box.y99_1 = $now;
        $box.z99_1 = $stopIds;
        $box.a9a_1 = $favorites;
        $box.b9a_1 = $sortByDistanceFrom;
        super(resultContinuation, $box);
      }
      b99($this$withContext, $completion) {
        var tmp = this.y3e($this$withContext, $completion);
        tmp.hd_1 = Unit_instance;
        tmp.id_1 = null;
        return tmp.nd();
      }
      ne(p1, $completion) {
        return this.b99((!(p1 == null) ? isInterface(p1, CoroutineScope()) : false) ? p1 : THROW_CCE(), $completion);
      }
      nd() {
        var suspendResult = this.hd_1;
        $sm: do
          try {
            var tmp = this.fd_1;
            if (tmp === 0) {
              this.gd_1 = 1;
              if (this.w99_1 == null)
                return null;
              return sort((new (ListBuilder())(true, this.x99_1, this.y99_1)).g99(this.z99_1, this.w99_1, this.x99_1, this.a9a_1).m99(new (AlertsStreamDataResponse())(emptyMap()), false, this.y99_1, this.w99_1).n99(this.b9a_1), this.b9a_1, this.x99_1);
            } else if (tmp === 1) {
              throw this.id_1;
            }
          } catch ($p) {
            var e = $p;
            throw e;
          }
         while (true);
      }
      y3e($this$withContext, completion) {
        var i = new (RouteCardData$Companion$routeCardsForStaticStopList$slambda())(this.w99_1, this.x99_1, this.y99_1, this.z99_1, this.a9a_1, this.b9a_1, completion);
        i.c9a_1 = $this$withContext;
        return i;
      }
    }
    initMetadataForLambda($, VOID, VOID, [1]);
    RouteCardData$Companion$routeCardsForStaticStopList$slambdaClass = $;
  }
  return RouteCardData$Companion$routeCardsForStaticStopList$slambdaClass;
}
function RouteCardData$Companion$routeCardsForStaticStopList$slambda_0($globalData, $context, $now, $stopIds, $favorites, $sortByDistanceFrom, resultContinuation) {
  var i = new (RouteCardData$Companion$routeCardsForStaticStopList$slambda())($globalData, $context, $now, $stopIds, $favorites, $sortByDistanceFrom, resultContinuation);
  var l = function ($this$withContext, $completion) {
    return i.b99($this$withContext, $completion);
  };
  l.$arity = 1;
  return l;
}
function parentStop($this, global, stopId) {
  var tmp0_elvis_lhs = global.n8u_1.j3(stopId);
  var tmp;
  if (tmp0_elvis_lhs == null) {
    return null;
  } else {
    tmp = tmp0_elvis_lhs;
  }
  var stop = tmp;
  return stop.d9a(global.n8u_1);
}
function lineOrRouteId($this, global, routeId) {
  var tmp0_elvis_lhs = global.l8u_1.j3(routeId);
  var tmp;
  if (tmp0_elvis_lhs == null) {
    return null;
  } else {
    tmp = tmp0_elvis_lhs;
  }
  var route = tmp;
  // Inline function 'kotlin.let' call
  var it = route.y8r_1;
  // Inline function 'kotlin.collections.get' call
  var this_0 = global.j8u_1;
  var line = (isInterface(this_0, KtMap()) ? this_0 : THROW_CCE()).j3(it);
  var tmp_0;
  if (!(line == null) && line.b93_1 && !route.b8s_1) {
    tmp_0 = line.v92_1;
  } else {
    tmp_0 = routeId;
  }
  return tmp_0;
}
function forEachLeaf($this, process) {
  // Inline function 'kotlin.collections.iterator' call
  var _iterator__ex2g4s = $this.f99_1.t1().x();
  while (_iterator__ex2g4s.y()) {
    var _destruct__k2r9zo = _iterator__ex2g4s.z();
    // Inline function 'kotlin.collections.component1' call
    var routeOrLineId = _destruct__k2r9zo.u1();
    // Inline function 'kotlin.collections.component2' call
    var byStopId = _destruct__k2r9zo.v1();
    // Inline function 'kotlin.collections.iterator' call
    var _iterator__ex2g4s_0 = byStopId.f9a_1.t1().x();
    while (_iterator__ex2g4s_0.y()) {
      var _destruct__k2r9zo_0 = _iterator__ex2g4s_0.z();
      // Inline function 'kotlin.collections.component1' call
      var stopId = _destruct__k2r9zo_0.u1();
      // Inline function 'kotlin.collections.component2' call
      var byDirectionId = _destruct__k2r9zo_0.v1();
      // Inline function 'kotlin.collections.iterator' call
      var _iterator__ex2g4s_1 = byDirectionId.k9a_1.t1().x();
      while (_iterator__ex2g4s_1.y()) {
        var _destruct__k2r9zo_1 = _iterator__ex2g4s_1.z();
        // Inline function 'kotlin.collections.component1' call
        var directionId = _destruct__k2r9zo_1.u1();
        // Inline function 'kotlin.collections.component2' call
        var leaf = _destruct__k2r9zo_1.v1();
        process(new (HierarchyPath())(routeOrLineId, stopId, directionId), leaf);
      }
    }
  }
}
function filterRelevantAlerts($this, alerts, includeMinorAlerts, filterAtTime) {
  var tmp1_safe_receiver = alerts == null ? null : alerts.y91_1;
  var tmp2_safe_receiver = tmp1_safe_receiver == null ? null : tmp1_safe_receiver.l3();
  var tmp;
  if (tmp2_safe_receiver == null) {
    tmp = null;
  } else {
    // Inline function 'kotlin.collections.filter' call
    // Inline function 'kotlin.collections.filterTo' call
    var destination = ArrayList().g1();
    var _iterator__ex2g4s = tmp2_safe_receiver.x();
    while (_iterator__ex2g4s.y()) {
      var element = _iterator__ex2g4s.z();
      if (element.c90(filterAtTime) && element.k8z_1.a4(includeMinorAlerts ? AlertSignificance_Minor_getInstance() : AlertSignificance_Accessibility_getInstance()) >= 0) {
        destination.i(element);
      }
    }
    tmp = destination;
  }
  var tmp3_elvis_lhs = tmp;
  return tmp3_elvis_lhs == null ? emptyList() : tmp3_elvis_lhs;
}
function RouteCardData$ListBuilder$addUpcomingTrips$lambda($upcomingTripsBySlot, $schedules, $hasSchedulesTodayByPattern) {
  return function (path, leafBuilder) {
    var upcomingTripsHere = $upcomingTripsBySlot.j3(path);
    var tmp0_elvis_lhs = leafBuilder.o9a_1;
    // Inline function 'kotlin.collections.map' call
    var this_0 = tmp0_elvis_lhs == null ? emptyList() : tmp0_elvis_lhs;
    // Inline function 'kotlin.collections.mapTo' call
    var destination = ArrayList().w(collectionSizeOrDefault(this_0, 10));
    var _iterator__ex2g4s = this_0.x();
    while (_iterator__ex2g4s.y()) {
      var item = _iterator__ex2g4s.z();
      var tmp$ret$0 = item.r8z_1;
      destination.i(tmp$ret$0);
    }
    var patternIds = toSet(destination);
    leafBuilder.r9a_1 = upcomingTripsHere;
    leafBuilder.t9a_1 = !($schedules == null);
    var tmp = leafBuilder;
    var tmp1_safe_receiver = $hasSchedulesTodayByPattern;
    var tmp_0;
    if (tmp1_safe_receiver == null) {
      tmp_0 = null;
    } else {
      // Inline function 'kotlin.let' call
      // Inline function 'kotlin.collections.associateWith' call
      var result = LinkedHashMap().tc(coerceAtLeast(mapCapacity(collectionSizeOrDefault(patternIds, 10)), 16));
      // Inline function 'kotlin.collections.associateWithTo' call
      var _iterator__ex2g4s_0 = patternIds.x();
      while (_iterator__ex2g4s_0.y()) {
        var element = _iterator__ex2g4s_0.z();
        // Inline function 'kotlin.collections.getOrElse' call
        var tmp0_elvis_lhs_0 = tmp1_safe_receiver.j3(element);
        var tmp_1;
        if (tmp0_elvis_lhs_0 == null) {
          tmp_1 = false;
        } else {
          tmp_1 = tmp0_elvis_lhs_0;
        }
        var tmp$ret$5 = tmp_1;
        result.t3(element, tmp$ret$5);
      }
      tmp_0 = result;
    }
    tmp.u9a_1 = tmp_0;
    return Unit_instance;
  };
}
function RouteCardData$ListBuilder$addAlerts$lambda($globalData, $activeRelevantAlerts) {
  return function (path, leafBuilder) {
    var tmp;
    if (startsWith(path.x9a_1, 'line-')) {
      var tmp0_safe_receiver = leafBuilder.o9a_1;
      var tmp_0;
      if (tmp0_safe_receiver == null) {
        tmp_0 = null;
      } else {
        // Inline function 'kotlin.collections.map' call
        // Inline function 'kotlin.collections.mapTo' call
        var destination = ArrayList().w(collectionSizeOrDefault(tmp0_safe_receiver, 10));
        var _iterator__ex2g4s = tmp0_safe_receiver.x();
        while (_iterator__ex2g4s.y()) {
          var item = _iterator__ex2g4s.z();
          var tmp$ret$0 = item.x8z_1;
          destination.i(tmp$ret$0);
        }
        tmp_0 = destination;
      }
      var tmp1_safe_receiver = tmp_0;
      var tmp2_safe_receiver = tmp1_safe_receiver == null ? null : distinct(tmp1_safe_receiver);
      var tmp_1;
      if (tmp2_safe_receiver == null) {
        tmp_1 = null;
      } else {
        // Inline function 'kotlin.takeUnless' call
        var tmp_2;
        if (!tmp2_safe_receiver.h1()) {
          tmp_2 = tmp2_safe_receiver;
        } else {
          tmp_2 = null;
        }
        tmp_1 = tmp_2;
      }
      var tmp3_elvis_lhs = tmp_1;
      var tmp_3;
      if (tmp3_elvis_lhs == null) {
        // Inline function 'kotlin.collections.orEmpty' call
        var tmp0_elvis_lhs = $globalData.q8u_1.j3(path.x9a_1);
        // Inline function 'kotlin.collections.map' call
        var this_0 = tmp0_elvis_lhs == null ? emptyList() : tmp0_elvis_lhs;
        // Inline function 'kotlin.collections.mapTo' call
        var destination_0 = ArrayList().w(collectionSizeOrDefault(this_0, 10));
        var _iterator__ex2g4s_0 = this_0.x();
        while (_iterator__ex2g4s_0.y()) {
          var item_0 = _iterator__ex2g4s_0.z();
          var tmp$ret$6 = item_0.o8r_1;
          destination_0.i(tmp$ret$6);
        }
        tmp_3 = destination_0;
      } else {
        tmp_3 = tmp3_elvis_lhs;
      }
      tmp = tmp_3;
    } else {
      tmp = listOf(path.x9a_1);
    }
    var routes = tmp;
    var tmp4_safe_receiver = $globalData.a9b(path.y9a_1);
    var tmp5_elvis_lhs = tmp4_safe_receiver == null ? null : tmp4_safe_receiver.j8r_1;
    var isCRCore = tmp5_elvis_lhs == null ? false : tmp5_elvis_lhs;
    var applicableAlerts = discardTrackChangesAtCRCore(Companion_getInstance_0().u8y($activeRelevantAlerts, path.z9a_1, routes, leafBuilder.q9a_1, null), isCRCore);
    var tmp_4 = Companion_getInstance_0();
    // Inline function 'kotlin.collections.orEmpty' call
    var tmp0_elvis_lhs_0 = leafBuilder.o9a_1;
    var tmp_5 = tmp0_elvis_lhs_0 == null ? emptyList() : tmp0_elvis_lhs_0;
    // Inline function 'kotlin.collections.orEmpty' call
    var tmp0_elvis_lhs_1 = leafBuilder.q9a_1;
    var tmp$ret$10 = tmp0_elvis_lhs_1 == null ? emptySet() : tmp0_elvis_lhs_1;
    var downstreamAlerts = tmp_4.q8z($activeRelevantAlerts, tmp_5, tmp$ret$10, $globalData.o8u_1);
    var tmp_6 = Companion_getInstance_0();
    // Inline function 'kotlin.collections.orEmpty' call
    var tmp0_elvis_lhs_2 = leafBuilder.q9a_1;
    var tmp$ret$11 = tmp0_elvis_lhs_2 == null ? emptySet() : tmp0_elvis_lhs_2;
    var elevatorAlerts = tmp_6.n8z($activeRelevantAlerts, tmp$ret$11);
    leafBuilder.s9a_1 = distinct(plus(applicableAlerts, elevatorAlerts));
    leafBuilder.v9a_1 = downstreamAlerts;
    return Unit_instance;
  };
}
function isTypicalLastStopOnRoutePattern($this, stop, globalData) {
  var tmp0_safe_receiver = $this.o9a_1;
  var tmp;
  if (tmp0_safe_receiver == null) {
    tmp = null;
  } else {
    // Inline function 'kotlin.collections.filter' call
    // Inline function 'kotlin.collections.filterTo' call
    var destination = ArrayList().g1();
    var _iterator__ex2g4s = tmp0_safe_receiver.x();
    while (_iterator__ex2g4s.y()) {
      var element = _iterator__ex2g4s.z();
      if (equals(element.v8z_1, Typicality_Typical_getInstance())) {
        destination.i(element);
      }
    }
    tmp = destination;
  }
  var tmp1_safe_receiver = tmp;
  var tmp_0;
  if (tmp1_safe_receiver == null) {
    tmp_0 = null;
  } else {
    // Inline function 'kotlin.collections.map' call
    // Inline function 'kotlin.collections.mapTo' call
    var destination_0 = ArrayList().w(collectionSizeOrDefault(tmp1_safe_receiver, 10));
    var _iterator__ex2g4s_0 = tmp1_safe_receiver.x();
    while (_iterator__ex2g4s_0.y()) {
      var item = _iterator__ex2g4s_0.z();
      var tmp$ret$3 = item.w8z_1;
      destination_0.i(tmp$ret$3);
    }
    tmp_0 = destination_0;
  }
  var tmp2_safe_receiver = tmp_0;
  var tmp_1;
  if (tmp2_safe_receiver == null) {
    tmp_1 = null;
  } else {
    // Inline function 'kotlin.takeUnless' call
    var tmp_2;
    if (!tmp2_safe_receiver.h1()) {
      tmp_2 = tmp2_safe_receiver;
    } else {
      tmp_2 = null;
    }
    tmp_1 = tmp_2;
  }
  var tmp3_safe_receiver = tmp_1;
  var tmp_3;
  if (tmp3_safe_receiver == null) {
    tmp_3 = null;
  } else {
    var tmp$ret$8;
    $l$block_1: {
      // Inline function 'kotlin.collections.all' call
      var tmp_4;
      if (isInterface(tmp3_safe_receiver, Collection())) {
        tmp_4 = tmp3_safe_receiver.h1();
      } else {
        tmp_4 = false;
      }
      if (tmp_4) {
        tmp$ret$8 = true;
        break $l$block_1;
      }
      var _iterator__ex2g4s_1 = tmp3_safe_receiver.x();
      while (_iterator__ex2g4s_1.y()) {
        var element_0 = _iterator__ex2g4s_1.z();
        var tmp$ret$9;
        $l$block_0: {
          var representativeTrip = globalData.o8u_1.j3(element_0);
          var tmp1_safe_receiver_0 = representativeTrip == null ? null : representativeTrip.u8t_1;
          var tmp2_elvis_lhs = tmp1_safe_receiver_0 == null ? null : last(tmp1_safe_receiver_0);
          var tmp_5;
          if (tmp2_elvis_lhs == null) {
            tmp$ret$9 = false;
            break $l$block_0;
          } else {
            tmp_5 = tmp2_elvis_lhs;
          }
          var lastStopIdInPattern = tmp_5;
          tmp$ret$9 = lastStopIdInPattern === stop.v8q_1 || stop.e8r_1.j1(lastStopIdInPattern);
        }
        if (!tmp$ret$9) {
          tmp$ret$8 = false;
          break $l$block_1;
        }
      }
      tmp$ret$8 = true;
    }
    tmp_3 = tmp$ret$8;
  }
  var tmp4_elvis_lhs = tmp_3;
  return tmp4_elvis_lhs == null ? false : tmp4_elvis_lhs;
}
var ContextClass;
function Context() {
  if (ContextClass === VOID) {
    class $ extends Enum() {
      l99() {
        return this.equals(Context_StopDetailsFiltered_getInstance_0()) || this.equals(Context_StopDetailsUnfiltered_getInstance_0());
      }
      b9b() {
        var tmp;
        switch (this.x3_1) {
          case 0:
          case 3:
            tmp = Context_NearbyTransit_getInstance();
            break;
          case 1:
            tmp = Context_StopDetailsFiltered_getInstance();
            break;
          case 2:
            tmp = Context_StopDetailsUnfiltered_getInstance();
            break;
          default:
            noWhenBranchMatchedException();
            break;
        }
        return tmp;
      }
    }
    initMetadataForClass($, 'Context');
    ContextClass = $;
  }
  return ContextClass;
}
var RouteStopDataClass;
function RouteStopData() {
  if (RouteStopDataClass === VOID) {
    class $ {
      constructor(lineOrRoute, stop, directions, data) {
        this.t8s_1 = lineOrRoute;
        this.u8s_1 = stop;
        this.v8s_1 = directions;
        this.w8s_1 = data;
        this.x8s_1 = this.u8s_1.v8q_1;
        var tmp = this;
        // Inline function 'kotlin.collections.map' call
        var this_0 = this.w8s_1;
        // Inline function 'kotlin.collections.mapTo' call
        var destination = ArrayList().w(collectionSizeOrDefault(this_0, 10));
        var _iterator__ex2g4s = this_0.x();
        while (_iterator__ex2g4s.y()) {
          var item = _iterator__ex2g4s.z();
          var tmp$ret$0 = item.b8t_1;
          destination.i(tmp$ret$0);
        }
        tmp.y8s_1 = toSet(destination);
      }
      toString() {
        return 'RouteStopData(lineOrRoute=' + toString(this.t8s_1) + ', stop=' + this.u8s_1.toString() + ', directions=' + toString(this.v8s_1) + ', data=' + toString(this.w8s_1) + ')';
      }
      hashCode() {
        var result = hashCode(this.t8s_1);
        result = imul(result, 31) + this.u8s_1.hashCode() | 0;
        result = imul(result, 31) + hashCode(this.v8s_1) | 0;
        result = imul(result, 31) + hashCode(this.w8s_1) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof RouteStopData()))
          return false;
        var tmp0_other_with_cast = other instanceof RouteStopData() ? other : THROW_CCE();
        if (!equals(this.t8s_1, tmp0_other_with_cast.t8s_1))
          return false;
        if (!this.u8s_1.equals(tmp0_other_with_cast.u8s_1))
          return false;
        if (!equals(this.v8s_1, tmp0_other_with_cast.v8s_1))
          return false;
        if (!equals(this.w8s_1, tmp0_other_with_cast.w8s_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'RouteStopData');
    RouteStopDataClass = $;
  }
  return RouteStopDataClass;
}
var LeafClass;
function Leaf() {
  if (LeafClass === VOID) {
    class $ {
      constructor(lineOrRoute, stop, directionId, routePatterns, stopIds, upcomingTrips, alertsHere, allDataLoaded, hasSchedulesTodayByPattern, alertsDownstream, context) {
        this.z8s_1 = lineOrRoute;
        this.a8t_1 = stop;
        this.b8t_1 = directionId;
        this.c8t_1 = routePatterns;
        this.d8t_1 = stopIds;
        this.e8t_1 = upcomingTrips;
        this.f8t_1 = alertsHere;
        this.g8t_1 = allDataLoaded;
        this.h8t_1 = hasSchedulesTodayByPattern;
        this.i8t_1 = alertsDownstream;
        this.j8t_1 = context;
        this.k8t_1 = this.b8t_1;
        var tmp = this;
        var tmp0 = this.h8t_1;
        var tmp$ret$0;
        $l$block_0: {
          // Inline function 'kotlin.collections.any' call
          if (tmp0.h1()) {
            tmp$ret$0 = false;
            break $l$block_0;
          }
          // Inline function 'kotlin.collections.iterator' call
          var _iterator__ex2g4s = tmp0.t1().x();
          while (_iterator__ex2g4s.y()) {
            var element = _iterator__ex2g4s.z();
            if (element.v1()) {
              tmp$ret$0 = true;
              break $l$block_0;
            }
          }
          tmp$ret$0 = false;
        }
        tmp.l8t_1 = tmp$ret$0;
        var tmp_0 = this;
        var tmp0_0 = this.f8t_1;
        var tmp$ret$4;
        $l$block_1: {
          // Inline function 'kotlin.collections.firstOrNull' call
          var _iterator__ex2g4s_0 = tmp0_0.x();
          while (_iterator__ex2g4s_0.y()) {
            var element_0 = _iterator__ex2g4s_0.z();
            if (element_0.k8z_1.a4(AlertSignificance_Major_getInstance()) >= 0) {
              tmp$ret$4 = element_0;
              break $l$block_1;
            }
          }
          tmp$ret$4 = null;
        }
        tmp_0.m8t_1 = tmp$ret$4;
        var tmp_1 = this;
        var tmp0_1 = this.f8t_1;
        var tmp$ret$6;
        $l$block_2: {
          // Inline function 'kotlin.collections.firstOrNull' call
          var _iterator__ex2g4s_1 = tmp0_1.x();
          while (_iterator__ex2g4s_1.y()) {
            var element_1 = _iterator__ex2g4s_1.z();
            if (element_1.k8z_1.a4(AlertSignificance_Major_getInstance()) < 0 && element_1.k8z_1.a4(AlertSignificance_Secondary_getInstance()) >= 0) {
              tmp$ret$6 = element_1;
              break $l$block_2;
            }
          }
          tmp$ret$6 = null;
        }
        var tmp0_elvis_lhs = tmp$ret$6;
        tmp_1.n8t_1 = tmp0_elvis_lhs == null ? firstOrNull(this.i8t_1) : tmp0_elvis_lhs;
      }
      t94() {
        // Inline function 'kotlin.run' call
        var tmp0 = this.f8t_1;
        var tmp$ret$0;
        $l$block_0: {
          // Inline function 'kotlin.collections.any' call
          var tmp;
          if (isInterface(tmp0, Collection())) {
            tmp = tmp0.h1();
          } else {
            tmp = false;
          }
          if (tmp) {
            tmp$ret$0 = false;
            break $l$block_0;
          }
          var _iterator__ex2g4s = tmp0.x();
          while (_iterator__ex2g4s.y()) {
            var element = _iterator__ex2g4s.z();
            if (element.k8z_1.equals(AlertSignificance_Major_getInstance())) {
              tmp$ret$0 = true;
              break $l$block_0;
            }
          }
          tmp$ret$0 = false;
        }
        return tmp$ret$0;
      }
      c9b(now, globalData) {
        var representativeRoute = this.z8s_1.x94();
        var potentialService_0 = potentialService(this, now, representativeRoute, globalData, this.j8t_1);
        var tmp = this.z8s_1;
        var shouldIncludeRoute = tmp instanceof Line();
        var isBranching = potentialService_0.c1() > 1;
        var routeType = representativeRoute.p8r_1;
        var translatedContext = this.j8t_1.b9b();
        var countTripsToDisplay = this.j8t_1.equals(Context_StopDetailsFiltered_getInstance_0()) ? null : isBranching && !routeType.equals(RouteType_BUS_getInstance()) ? 3 : 2;
        var tripsToShow = withFormat(this.e8t_1, now, representativeRoute, translatedContext, countTripsToDisplay);
        var mapStopRoute = Companion_getInstance_2().n90(representativeRoute);
        var tmp_0;
        if (this.n8t_1 == null) {
          tmp_0 = null;
        } else {
          // Inline function 'kotlin.let' call
          tmp_0 = SecondaryAlert().e9b(StopAlertState_Issue_getInstance(), mapStopRoute);
        }
        var secondaryAlert = tmp_0;
        if (this.m8t_1 == null && tripsToShow.h1()) {
          var service = isBranching ? null : firstOrNull_0(potentialService_0);
          var tmp_1;
          if (globalData == null) {
            tmp_1 = null;
          } else {
            tmp_1 = globalData.s97(service == null ? null : service.d97_1);
          }
          var tmp3_safe_receiver = tmp_1;
          var tmp_2;
          if (tmp3_safe_receiver == null) {
            tmp_2 = null;
          } else {
            // Inline function 'kotlin.takeIf' call
            var tmp_3;
            if (shouldIncludeRoute) {
              tmp_3 = tmp3_safe_receiver;
            } else {
              tmp_3 = null;
            }
            tmp_2 = tmp_3;
          }
          var route = tmp_2;
          var tmp_4;
          if (!this.g8t_1) {
            tmp_4 = new (Single())(route, service == null ? null : service.e97_1, Loading_getInstance());
          } else {
            tmp_4 = new (Single())(route, service == null ? null : service.e97_1, NoTrips().a98(Companion_instance.x97(this.e8t_1, this.l8t_1, now), secondaryAlert));
          }
          return tmp_4;
        }
        var tmp_5;
        if (isBranching) {
          tmp_5 = formatForBranchedService(this, potentialService_0, tripsToShow, mapStopRoute, secondaryAlert, globalData, now);
        } else {
          var tmp_6;
          if (globalData == null) {
            tmp_6 = null;
          } else {
            var tmp7_safe_receiver = singleOrNull(potentialService_0);
            tmp_6 = globalData.s97(tmp7_safe_receiver == null ? null : tmp7_safe_receiver.d97_1);
          }
          var tmp8_safe_receiver = tmp_6;
          var tmp_7;
          if (tmp8_safe_receiver == null) {
            tmp_7 = null;
          } else {
            // Inline function 'kotlin.takeIf' call
            var tmp_8;
            if (shouldIncludeRoute) {
              tmp_8 = tmp8_safe_receiver;
            } else {
              tmp_8 = null;
            }
            tmp_7 = tmp_8;
          }
          var tmp_9 = tmp_7;
          var tmp9_safe_receiver = singleOrNull(potentialService_0);
          var tmp_10 = tmp9_safe_receiver == null ? null : tmp9_safe_receiver.e97_1;
          // Inline function 'kotlin.collections.map' call
          // Inline function 'kotlin.collections.mapTo' call
          var destination = ArrayList().w(collectionSizeOrDefault(tripsToShow, 10));
          var _iterator__ex2g4s = tripsToShow.x();
          while (_iterator__ex2g4s.y()) {
            var item = _iterator__ex2g4s.z();
            var tmp$ret$6 = item.bh_1;
            destination.i(tmp$ret$6);
          }
          tmp_5 = formatForSingleHeadsignService(this, tmp_9, tmp_10, destination, mapStopRoute, secondaryAlert);
        }
        return tmp_5;
      }
      toString() {
        return 'Leaf(lineOrRoute=' + toString(this.z8s_1) + ', stop=' + this.a8t_1.toString() + ', directionId=' + this.b8t_1 + ', routePatterns=' + toString(this.c8t_1) + ', stopIds=' + toString(this.d8t_1) + ', upcomingTrips=' + toString(this.e8t_1) + ', alertsHere=' + toString(this.f8t_1) + ', allDataLoaded=' + this.g8t_1 + ', hasSchedulesTodayByPattern=' + toString(this.h8t_1) + ', alertsDownstream=' + toString(this.i8t_1) + ', context=' + this.j8t_1.toString() + ')';
      }
      hashCode() {
        var result = hashCode(this.z8s_1);
        result = imul(result, 31) + this.a8t_1.hashCode() | 0;
        result = imul(result, 31) + this.b8t_1 | 0;
        result = imul(result, 31) + hashCode(this.c8t_1) | 0;
        result = imul(result, 31) + hashCode(this.d8t_1) | 0;
        result = imul(result, 31) + hashCode(this.e8t_1) | 0;
        result = imul(result, 31) + hashCode(this.f8t_1) | 0;
        result = imul(result, 31) + getBooleanHashCode(this.g8t_1) | 0;
        result = imul(result, 31) + hashCode(this.h8t_1) | 0;
        result = imul(result, 31) + hashCode(this.i8t_1) | 0;
        result = imul(result, 31) + this.j8t_1.hashCode() | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof Leaf()))
          return false;
        var tmp0_other_with_cast = other instanceof Leaf() ? other : THROW_CCE();
        if (!equals(this.z8s_1, tmp0_other_with_cast.z8s_1))
          return false;
        if (!this.a8t_1.equals(tmp0_other_with_cast.a8t_1))
          return false;
        if (!(this.b8t_1 === tmp0_other_with_cast.b8t_1))
          return false;
        if (!equals(this.c8t_1, tmp0_other_with_cast.c8t_1))
          return false;
        if (!equals(this.d8t_1, tmp0_other_with_cast.d8t_1))
          return false;
        if (!equals(this.e8t_1, tmp0_other_with_cast.e8t_1))
          return false;
        if (!equals(this.f8t_1, tmp0_other_with_cast.f8t_1))
          return false;
        if (!(this.g8t_1 === tmp0_other_with_cast.g8t_1))
          return false;
        if (!equals(this.h8t_1, tmp0_other_with_cast.h8t_1))
          return false;
        if (!equals(this.i8t_1, tmp0_other_with_cast.i8t_1))
          return false;
        if (!this.j8t_1.equals(tmp0_other_with_cast.j8t_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'Leaf');
    LeafClass = $;
  }
  return LeafClass;
}
var LineOrRouteClass;
function LineOrRoute() {
  if (LineOrRouteClass === VOID) {
    class $ {
      d8h() {
        var tmp;
        if (this instanceof Line()) {
          tmp = this.d98_1.v92_1;
        } else {
          if (this instanceof Route()) {
            tmp = this.i98_1.o8r_1;
          } else {
            noWhenBranchMatchedException();
          }
        }
        return tmp;
      }
      f98() {
        var tmp;
        if (this instanceof Line()) {
          tmp = this.x94().p8r_1;
        } else {
          if (this instanceof Route()) {
            tmp = this.i98_1.p8r_1;
          } else {
            noWhenBranchMatchedException();
          }
        }
        return tmp;
      }
      g98() {
        var tmp;
        if (this instanceof Line()) {
          var tmp0 = this.e98_1;
          var tmp$ret$0;
          $l$block_0: {
            // Inline function 'kotlin.collections.any' call
            var tmp_0;
            if (isInterface(tmp0, Collection())) {
              tmp_0 = tmp0.h1();
            } else {
              tmp_0 = false;
            }
            if (tmp_0) {
              tmp$ret$0 = false;
              break $l$block_0;
            }
            var _iterator__ex2g4s = tmp0.x();
            while (_iterator__ex2g4s.y()) {
              var element = _iterator__ex2g4s.z();
              if (element.p8r_1.w94()) {
                tmp$ret$0 = true;
                break $l$block_0;
              }
            }
            tmp$ret$0 = false;
          }
          tmp = tmp$ret$0;
        } else {
          if (this instanceof Route()) {
            tmp = this.i98_1.p8r_1.w94();
          } else {
            noWhenBranchMatchedException();
          }
        }
        return tmp;
      }
      x94() {
        var tmp;
        if (this instanceof Route()) {
          tmp = this.i98_1;
        } else {
          if (this instanceof Line()) {
            tmp = min(this.e98_1);
          } else {
            noWhenBranchMatchedException();
          }
        }
        return tmp;
      }
      h98(globalData, stop, patterns) {
        var tmp;
        if (this instanceof Line()) {
          tmp = Companion_getInstance_3().x90(globalData, stop, patterns);
        } else {
          if (this instanceof Route()) {
            tmp = Companion_getInstance_3().s90(globalData, stop, this.i98_1, patterns);
          } else {
            noWhenBranchMatchedException();
          }
        }
        return tmp;
      }
    }
    initMetadataForClass($, 'LineOrRoute');
    LineOrRouteClass = $;
  }
  return LineOrRouteClass;
}
var CompanionClass;
function Companion() {
  if (CompanionClass === VOID) {
    class $ {
      constructor() {
        this.p97_1 = 2;
        this.q97_1 = 3;
      }
      f9b(stopIds, globalData, sortByDistanceFrom, schedules, predictions, alerts, now, context, favorites, coroutineDispatcher, $completion) {
        return withContext(coroutineDispatcher, RouteCardData$Companion$routeCardsForStopList$slambda_0(predictions, alerts, globalData, context, now, schedules, stopIds, favorites, sortByDistanceFrom, null), $completion);
      }
      g9b(stopIds, globalData, sortByDistanceFrom, schedules, predictions, alerts, now, context, favorites, coroutineDispatcher, $completion, $super) {
        favorites = favorites === VOID ? null : favorites;
        coroutineDispatcher = coroutineDispatcher === VOID ? Dispatchers_getInstance().u28_1 : coroutineDispatcher;
        return $super === VOID ? this.f9b(stopIds, globalData, sortByDistanceFrom, schedules, predictions, alerts, now, context, favorites, coroutineDispatcher, $completion) : $super.f9b.call(this, stopIds, globalData, sortByDistanceFrom, schedules, predictions, alerts, now, context, favorites, coroutineDispatcher, $completion);
      }
      h9b(stopIds, globalData, context, now, sortByDistanceFrom, favorites, coroutineDispatcher, $completion) {
        return withContext(coroutineDispatcher, RouteCardData$Companion$routeCardsForStaticStopList$slambda_0(globalData, context, now, stopIds, favorites, sortByDistanceFrom, null), $completion);
      }
      r97(routePatterns, global, localStops) {
        // Inline function 'kotlin.collections.mutableSetOf' call
        // Inline function 'kotlin.collections.flatMapTo' call
        var destination = LinkedHashSet().f1();
        var _iterator__ex2g4s = routePatterns.x();
        while (_iterator__ex2g4s.y()) {
          var element = _iterator__ex2g4s.z();
          var tmp0_safe_receiver = global.o8u_1.j3(element.w8z_1);
          // Inline function 'kotlin.collections.orEmpty' call
          var tmp0_elvis_lhs = tmp0_safe_receiver == null ? null : tmp0_safe_receiver.u8t_1;
          var list = tmp0_elvis_lhs == null ? emptyList() : tmp0_elvis_lhs;
          addAll(destination, list);
        }
        var patternsStops = destination;
        var relevantStops = intersect(patternsStops, localStops);
        // Inline function 'kotlin.collections.ifEmpty' call
        var tmp;
        if (relevantStops.h1()) {
          tmp = localStops;
        } else {
          tmp = relevantStops;
        }
        return tmp;
      }
    }
    initMetadataForCompanion($, VOID, VOID, [10, 7]);
    CompanionClass = $;
  }
  return CompanionClass;
}
var Companion_instance_1;
function Companion_getInstance_5() {
  return Companion_instance_1;
}
var HierarchyPathClass;
function HierarchyPath() {
  if (HierarchyPathClass === VOID) {
    class $ {
      constructor(routeOrLineId, stopId, directionId) {
        this.x9a_1 = routeOrLineId;
        this.y9a_1 = stopId;
        this.z9a_1 = directionId;
      }
      toString() {
        return 'HierarchyPath(routeOrLineId=' + this.x9a_1 + ', stopId=' + this.y9a_1 + ', directionId=' + this.z9a_1 + ')';
      }
      hashCode() {
        var result = getStringHashCode(this.x9a_1);
        result = imul(result, 31) + getStringHashCode(this.y9a_1) | 0;
        result = imul(result, 31) + this.z9a_1 | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof HierarchyPath()))
          return false;
        var tmp0_other_with_cast = other instanceof HierarchyPath() ? other : THROW_CCE();
        if (!(this.x9a_1 === tmp0_other_with_cast.x9a_1))
          return false;
        if (!(this.y9a_1 === tmp0_other_with_cast.y9a_1))
          return false;
        if (!(this.z9a_1 === tmp0_other_with_cast.z9a_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'HierarchyPath');
    HierarchyPathClass = $;
  }
  return HierarchyPathClass;
}
var ListBuilderClass;
function ListBuilder() {
  if (ListBuilderClass === VOID) {
    class $ {
      constructor(allDataLoaded, context, now) {
        this.c99_1 = allDataLoaded;
        this.d99_1 = context;
        this.e99_1 = now;
        var tmp = this;
        // Inline function 'kotlin.collections.mutableMapOf' call
        tmp.f99_1 = LinkedHashMap().sc();
      }
      g99(stopIds, globalData, context, favorites) {
        var parentToAllStops = Companion_getInstance_4().k9b(stopIds, globalData);
        var patternsGrouped = Companion_getInstance_1().m9b(parentToAllStops, globalData, context, favorites);
        // Inline function 'kotlin.collections.map' call
        // Inline function 'kotlin.collections.mapTo' call
        var destination = ArrayList().w(patternsGrouped.c1());
        // Inline function 'kotlin.collections.iterator' call
        var _iterator__ex2g4s = patternsGrouped.t1().x();
        while (_iterator__ex2g4s.y()) {
          var item = _iterator__ex2g4s.z();
          // Inline function 'kotlin.collections.component1' call
          var lineOrRoute = item.u1();
          // Inline function 'kotlin.collections.component2' call
          var patternsByStop = item.v1();
          var key = lineOrRoute.d8h();
          // Inline function 'kotlin.collections.map' call
          // Inline function 'kotlin.collections.mapTo' call
          var destination_0 = ArrayList().w(patternsByStop.c1());
          // Inline function 'kotlin.collections.iterator' call
          var _iterator__ex2g4s_0 = patternsByStop.t1().x();
          while (_iterator__ex2g4s_0.y()) {
            var item_0 = _iterator__ex2g4s_0.z();
            // Inline function 'kotlin.collections.component1' call
            var stop = item_0.u1();
            // Inline function 'kotlin.collections.component2' call
            var patternsForStop = item_0.v1();
            // Inline function 'kotlin.collections.filter' call
            var tmp0 = patternsForStop.n9b_1;
            // Inline function 'kotlin.collections.filterTo' call
            var destination_1 = ArrayList().g1();
            var _iterator__ex2g4s_1 = tmp0.x();
            while (_iterator__ex2g4s_1.y()) {
              var element = _iterator__ex2g4s_1.z();
              if (element.j97()) {
                destination_1.i(element);
              }
            }
            var directions = lineOrRoute.h98(globalData, stop, destination_1);
            // Inline function 'kotlin.collections.groupBy' call
            var tmp0_0 = patternsForStop.n9b_1;
            // Inline function 'kotlin.collections.groupByTo' call
            var destination_2 = LinkedHashMap().sc();
            var _iterator__ex2g4s_2 = tmp0_0.x();
            while (_iterator__ex2g4s_2.y()) {
              var element_0 = _iterator__ex2g4s_2.z();
              var key_0 = element_0.s8z_1;
              // Inline function 'kotlin.collections.getOrPut' call
              var value = destination_2.j3(key_0);
              var tmp;
              if (value == null) {
                var answer = ArrayList().g1();
                destination_2.t3(key_0, answer);
                tmp = answer;
              } else {
                tmp = value;
              }
              var list = tmp;
              list.i(element_0);
            }
            // Inline function 'kotlin.collections.mapValues' call
            // Inline function 'kotlin.collections.mapValuesTo' call
            var destination_3 = LinkedHashMap().tc(mapCapacity(destination_2.c1()));
            // Inline function 'kotlin.collections.associateByTo' call
            var _iterator__ex2g4s_3 = destination_2.t1().x();
            while (_iterator__ex2g4s_3.y()) {
              var element_1 = _iterator__ex2g4s_3.z();
              var tmp_0 = element_1.u1();
              // Inline function 'kotlin.collections.component1' call
              var directionId = element_1.u1();
              // Inline function 'kotlin.collections.component2' call
              var patterns = element_1.v1();
              // Inline function 'kotlin.collections.map' call
              // Inline function 'kotlin.collections.mapTo' call
              var destination_4 = ArrayList().w(collectionSizeOrDefault(patterns, 10));
              var _iterator__ex2g4s_4 = patterns.x();
              while (_iterator__ex2g4s_4.y()) {
                var item_1 = _iterator__ex2g4s_4.z();
                var tmp$ret$17 = item_1.r8z_1;
                destination_4.i(tmp$ret$17);
              }
              var tmp_1 = intersect(toSet(destination_4), patternsForStop.o9b_1);
              var tmp_2 = Companion_instance_1;
              // Inline function 'kotlin.collections.getOrElse' call
              var tmp0_elvis_lhs = parentToAllStops.j3(stop);
              var tmp_3;
              if (tmp0_elvis_lhs == null) {
                tmp_3 = setOf(stop.v8q_1);
              } else {
                tmp_3 = tmp0_elvis_lhs;
              }
              var tmp$ret$21 = tmp_3;
              var tmp$ret$22 = new (LeafBuilder())(lineOrRoute, stop, directionId, patterns, tmp_1, tmp_2.r97(patterns, globalData, tmp$ret$21), VOID, VOID, this.c99_1, VOID, VOID, context);
              destination_3.t3(tmp_0, tmp$ret$22);
            }
            var tmp$ret$26 = to(stop.v8q_1, new (RouteStopDataBuilder())(lineOrRoute, stop, directions, destination_3));
            destination_0.i(tmp$ret$26);
          }
          var tmp$ret$29 = to(key, new (Builder())(lineOrRoute, toMap(destination_0), this.e99_1));
          destination.i(tmp$ret$29);
        }
        var builderData = toMap(destination);
        this.f99_1 = builderData;
        return this;
      }
      h99(schedules, predictions, filterAtTime, globalData) {
        var tmp = Companion_instance_0;
        // Inline function 'kotlin.collections.orEmpty' call
        var tmp0_elvis_lhs = schedules == null ? null : schedules.p9b_1;
        var tmp_0 = tmp0_elvis_lhs == null ? emptyList() : tmp0_elvis_lhs;
        var tmp_1 = toList(predictions.r9b_1.l3());
        // Inline function 'kotlin.collections.orEmpty' call
        var tmp0_elvis_lhs_0 = schedules == null ? null : schedules.q9b_1;
        var tmp$ret$1 = tmp0_elvis_lhs_0 == null ? emptyMap() : tmp0_elvis_lhs_0;
        var upcomingTrips = tmp.u9b(globalData.n8u_1, tmp_0, tmp_1, plus_0(tmp$ret$1, predictions.s9b_1), predictions.t9b_1, filterAtTime);
        // Inline function 'kotlin.collections.mutableMapOf' call
        var upcomingTripsBySlot = LinkedHashMap().sc();
        var _iterator__ex2g4s = upcomingTrips.x();
        $l$loop_0: while (_iterator__ex2g4s.y()) {
          var upcomingTrip = _iterator__ex2g4s.z();
          var tmp2_safe_receiver = upcomingTrip.c8u_1;
          var tmp_2;
          if (tmp2_safe_receiver == null) {
            tmp_2 = null;
          } else {
            // Inline function 'kotlin.let' call
            var tmp0_safe_receiver = parentStop(this, globalData, tmp2_safe_receiver);
            tmp_2 = tmp0_safe_receiver == null ? null : tmp0_safe_receiver.v8q_1;
          }
          var tmp3_elvis_lhs = tmp_2;
          var tmp_3;
          if (tmp3_elvis_lhs == null) {
            continue $l$loop_0;
          } else {
            tmp_3 = tmp3_elvis_lhs;
          }
          var parentStopId = tmp_3;
          var tmp4_elvis_lhs = lineOrRouteId(this, globalData, upcomingTrip.v8t_1.r8t_1);
          var tmp_4;
          if (tmp4_elvis_lhs == null) {
            continue $l$loop_0;
          } else {
            tmp_4 = tmp4_elvis_lhs;
          }
          var lineOrRouteId_0 = tmp_4;
          // Inline function 'kotlin.collections.getOrPut' call
          var key = new (HierarchyPath())(lineOrRouteId_0, parentStopId, upcomingTrip.v8t_1.p8t_1);
          var value = upcomingTripsBySlot.j3(key);
          var tmp_5;
          if (value == null) {
            // Inline function 'kotlin.collections.mutableListOf' call
            var answer = ArrayList().g1();
            upcomingTripsBySlot.t3(key, answer);
            tmp_5 = answer;
          } else {
            tmp_5 = value;
          }
          tmp_5.i(upcomingTrip);
        }
        var hasSchedulesTodayByPattern = schedules == null ? null : schedules.v9b();
        forEachLeaf(this, RouteCardData$ListBuilder$addUpcomingTrips$lambda(upcomingTripsBySlot, schedules, hasSchedulesTodayByPattern));
        return this;
      }
      m99(alerts, includeMinorAlerts, filterAtTime, globalData) {
        var activeRelevantAlerts = filterRelevantAlerts(this, alerts, includeMinorAlerts, filterAtTime);
        forEachLeaf(this, RouteCardData$ListBuilder$addAlerts$lambda(globalData, activeRelevantAlerts));
        return this;
      }
      i99(filterAtTime, cutoffTime, context, globalData) {
        var showAllPatternsWhileLoading = context.l99();
        // Inline function 'kotlin.collections.iterator' call
        var _iterator__ex2g4s = this.f99_1.t1().x();
        while (_iterator__ex2g4s.y()) {
          var entry = _iterator__ex2g4s.z();
          // Inline function 'kotlin.collections.component1' call
          var routeOrLineId = entry.u1();
          // Inline function 'kotlin.collections.component2' call
          var byStopId = entry.v1();
          // Inline function 'kotlin.collections.iterator' call
          var _iterator__ex2g4s_0 = byStopId.f9a_1.t1().x();
          while (_iterator__ex2g4s_0.y()) {
            var stopEntry = _iterator__ex2g4s_0.z();
            // Inline function 'kotlin.collections.component1' call
            var stopId = stopEntry.u1();
            // Inline function 'kotlin.collections.component2' call
            var byDirectionId = stopEntry.v1();
            var lineOrRoute = byStopId.e9a_1;
            var tmp = byDirectionId;
            // Inline function 'kotlin.collections.filter' call
            var tmp0 = byDirectionId.k9a_1;
            // Inline function 'kotlin.collections.filterTo' call
            var destination = LinkedHashMap().sc();
            // Inline function 'kotlin.collections.iterator' call
            var _iterator__ex2g4s_1 = tmp0.t1().x();
            while (_iterator__ex2g4s_1.y()) {
              var element = _iterator__ex2g4s_1.z();
              // Inline function 'kotlin.collections.component1' call
              var directionId = element.u1();
              // Inline function 'kotlin.collections.component2' call
              var leafBuilder = element.v1();
              if (leafBuilder.w9b(byDirectionId.i9a_1, filterAtTime, cutoffTime, showAllPatternsWhileLoading, lineOrRoute, globalData)) {
                destination.t3(element.u1(), element.v1());
              }
            }
            // Inline function 'kotlin.collections.mapValues' call
            // Inline function 'kotlin.collections.mapValuesTo' call
            var destination_0 = LinkedHashMap().tc(mapCapacity(destination.c1()));
            // Inline function 'kotlin.collections.associateByTo' call
            var _iterator__ex2g4s_2 = destination.t1().x();
            while (_iterator__ex2g4s_2.y()) {
              var element_0 = _iterator__ex2g4s_2.z();
              var tmp_0 = element_0.u1();
              // Inline function 'kotlin.collections.component1' call
              var directionId_0 = element_0.u1();
              // Inline function 'kotlin.collections.component2' call
              var leafBuilder_0 = element_0.v1();
              var tmp$ret$15 = leafBuilder_0.x9b(lineOrRoute.g98(), context).y9b();
              destination_0.t3(tmp_0, tmp$ret$15);
            }
            tmp.k9a_1 = destination_0;
          }
          var tmp_1 = byStopId;
          // Inline function 'kotlin.collections.filterNot' call
          var tmp0_0 = byStopId.f9a_1;
          // Inline function 'kotlin.collections.filterNotTo' call
          var destination_1 = LinkedHashMap().sc();
          // Inline function 'kotlin.collections.iterator' call
          var _iterator__ex2g4s_3 = tmp0_0.t1().x();
          while (_iterator__ex2g4s_3.y()) {
            var element_1 = _iterator__ex2g4s_3.z();
            if (!element_1.v1().k9a_1.h1()) {
              destination_1.t3(element_1.u1(), element_1.v1());
            }
          }
          tmp_1.f9a_1 = destination_1;
        }
        var tmp_2 = this;
        // Inline function 'kotlin.collections.filterNot' call
        var tmp0_1 = this.f99_1;
        // Inline function 'kotlin.collections.filterNotTo' call
        var destination_2 = LinkedHashMap().sc();
        // Inline function 'kotlin.collections.iterator' call
        var _iterator__ex2g4s_4 = tmp0_1.t1().x();
        while (_iterator__ex2g4s_4.y()) {
          var element_2 = _iterator__ex2g4s_4.z();
          if (!element_2.v1().f9a_1.h1()) {
            destination_2.t3(element_2.u1(), element_2.v1());
          }
        }
        tmp_2.f99_1 = destination_2;
        return this;
      }
      n99(sortByDistanceFrom) {
        // Inline function 'kotlin.collections.map' call
        var this_0 = this.f99_1;
        // Inline function 'kotlin.collections.mapTo' call
        var destination = ArrayList().w(this_0.c1());
        // Inline function 'kotlin.collections.iterator' call
        var _iterator__ex2g4s = this_0.t1().x();
        while (_iterator__ex2g4s.y()) {
          var item = _iterator__ex2g4s.z();
          var tmp = item.v1().e9a_1;
          // Inline function 'kotlin.collections.map' call
          var this_1 = item.v1().f9a_1.l3();
          // Inline function 'kotlin.collections.mapTo' call
          var destination_0 = ArrayList().w(collectionSizeOrDefault(this_1, 10));
          var _iterator__ex2g4s_0 = this_1.x();
          while (_iterator__ex2g4s_0.y()) {
            var item_0 = _iterator__ex2g4s_0.z();
            var tmp$ret$1 = item_0.r3q();
            destination_0.i(tmp$ret$1);
          }
          var tmp$ret$4 = new (RouteCardData())(tmp, sort_0(destination_0, sortByDistanceFrom), this.e99_1);
          destination.i(tmp$ret$4);
        }
        return destination;
      }
    }
    initMetadataForClass($, 'ListBuilder');
    ListBuilderClass = $;
  }
  return ListBuilderClass;
}
var BuilderClass;
function Builder() {
  if (BuilderClass === VOID) {
    class $ {
      constructor(lineOrRoute, stopData, now) {
        this.e9a_1 = lineOrRoute;
        this.f9a_1 = stopData;
        this.g9a_1 = now;
      }
      toString() {
        return 'Builder(lineOrRoute=' + toString(this.e9a_1) + ', stopData=' + toString(this.f9a_1) + ', now=' + this.g9a_1.toString() + ')';
      }
      hashCode() {
        var result = hashCode(this.e9a_1);
        result = imul(result, 31) + hashCode(this.f9a_1) | 0;
        result = imul(result, 31) + this.g9a_1.hashCode() | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof Builder()))
          return false;
        var tmp0_other_with_cast = other instanceof Builder() ? other : THROW_CCE();
        if (!equals(this.e9a_1, tmp0_other_with_cast.e9a_1))
          return false;
        if (!equals(this.f9a_1, tmp0_other_with_cast.f9a_1))
          return false;
        if (!this.g9a_1.equals(tmp0_other_with_cast.g9a_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'Builder');
    BuilderClass = $;
  }
  return BuilderClass;
}
var RouteStopDataBuilderClass;
function RouteStopDataBuilder() {
  if (RouteStopDataBuilderClass === VOID) {
    class $ {
      constructor(lineOrRoute, stop, directions, data) {
        this.h9a_1 = lineOrRoute;
        this.i9a_1 = stop;
        this.j9a_1 = directions;
        this.k9a_1 = data;
      }
      r3q() {
        // Inline function 'kotlin.collections.map' call
        var this_0 = this.k9a_1.l3();
        // Inline function 'kotlin.collections.mapTo' call
        var destination = ArrayList().w(collectionSizeOrDefault(this_0, 10));
        var _iterator__ex2g4s = this_0.x();
        while (_iterator__ex2g4s.y()) {
          var item = _iterator__ex2g4s.z();
          var tmp$ret$0 = item.r3q();
          destination.i(tmp$ret$0);
        }
        return new (RouteStopData())(this.h9a_1, this.i9a_1, this.j9a_1, sort_1(destination));
      }
      toString() {
        return 'RouteStopDataBuilder(lineOrRoute=' + toString(this.h9a_1) + ', stop=' + this.i9a_1.toString() + ', directions=' + toString(this.j9a_1) + ', data=' + toString(this.k9a_1) + ')';
      }
      hashCode() {
        var result = hashCode(this.h9a_1);
        result = imul(result, 31) + this.i9a_1.hashCode() | 0;
        result = imul(result, 31) + hashCode(this.j9a_1) | 0;
        result = imul(result, 31) + hashCode(this.k9a_1) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof RouteStopDataBuilder()))
          return false;
        var tmp0_other_with_cast = other instanceof RouteStopDataBuilder() ? other : THROW_CCE();
        if (!equals(this.h9a_1, tmp0_other_with_cast.h9a_1))
          return false;
        if (!this.i9a_1.equals(tmp0_other_with_cast.i9a_1))
          return false;
        if (!equals(this.j9a_1, tmp0_other_with_cast.j9a_1))
          return false;
        if (!equals(this.k9a_1, tmp0_other_with_cast.k9a_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'RouteStopDataBuilder');
    RouteStopDataBuilderClass = $;
  }
  return RouteStopDataBuilderClass;
}
var LeafBuilderClass;
function LeafBuilder() {
  if (LeafBuilderClass === VOID) {
    class $ {
      constructor(lineOrRoute, stop, directionId, routePatterns, patternsNotSeenAtEarlierStops, stopIds, upcomingTrips, alertsHere, allDataLoaded, hasSchedulesTodayByPattern, alertsDownstream, context) {
        routePatterns = routePatterns === VOID ? null : routePatterns;
        var tmp;
        if (patternsNotSeenAtEarlierStops === VOID) {
          var tmp0_safe_receiver = routePatterns;
          var tmp_0;
          if (tmp0_safe_receiver == null) {
            tmp_0 = null;
          } else {
            // Inline function 'kotlin.collections.map' call
            // Inline function 'kotlin.collections.mapTo' call
            var destination = ArrayList().w(collectionSizeOrDefault(tmp0_safe_receiver, 10));
            var _iterator__ex2g4s = tmp0_safe_receiver.x();
            while (_iterator__ex2g4s.y()) {
              var item = _iterator__ex2g4s.z();
              var tmp$ret$0 = item.r8z_1;
              destination.i(tmp$ret$0);
            }
            tmp_0 = destination;
          }
          var tmp1_safe_receiver = tmp_0;
          tmp = tmp1_safe_receiver == null ? null : toSet(tmp1_safe_receiver);
        } else {
          tmp = patternsNotSeenAtEarlierStops;
        }
        patternsNotSeenAtEarlierStops = tmp;
        stopIds = stopIds === VOID ? null : stopIds;
        upcomingTrips = upcomingTrips === VOID ? null : upcomingTrips;
        alertsHere = alertsHere === VOID ? null : alertsHere;
        allDataLoaded = allDataLoaded === VOID ? null : allDataLoaded;
        hasSchedulesTodayByPattern = hasSchedulesTodayByPattern === VOID ? null : hasSchedulesTodayByPattern;
        alertsDownstream = alertsDownstream === VOID ? null : alertsDownstream;
        this.l9a_1 = lineOrRoute;
        this.m9a_1 = stop;
        this.n9a_1 = directionId;
        this.o9a_1 = routePatterns;
        this.p9a_1 = patternsNotSeenAtEarlierStops;
        this.q9a_1 = stopIds;
        this.r9a_1 = upcomingTrips;
        this.s9a_1 = alertsHere;
        this.t9a_1 = allDataLoaded;
        this.u9a_1 = hasSchedulesTodayByPattern;
        this.v9a_1 = alertsDownstream;
        this.w9a_1 = context;
      }
      r3q() {
        // Inline function 'kotlin.checkNotNull' call
        var tmp0 = this.o9a_1;
        var tmp$ret$1;
        $l$block: {
          // Inline function 'kotlin.checkNotNull' call
          if (tmp0 == null) {
            var message = 'Required value was null.';
            throw IllegalStateException().o5(toString(message));
          } else {
            tmp$ret$1 = tmp0;
            break $l$block;
          }
        }
        var tmp = tmp$ret$1;
        // Inline function 'kotlin.checkNotNull' call
        var tmp0_0 = this.q9a_1;
        var tmp$ret$4;
        $l$block_0: {
          // Inline function 'kotlin.checkNotNull' call
          if (tmp0_0 == null) {
            var message_0 = 'Required value was null.';
            throw IllegalStateException().o5(toString(message_0));
          } else {
            tmp$ret$4 = tmp0_0;
            break $l$block_0;
          }
        }
        var tmp_0 = tmp$ret$4;
        var tmp0_elvis_lhs = this.r9a_1;
        var tmp_1 = tmp0_elvis_lhs == null ? emptyList() : tmp0_elvis_lhs;
        // Inline function 'kotlin.checkNotNull' call
        var tmp0_1 = this.s9a_1;
        var tmp$ret$7;
        $l$block_1: {
          // Inline function 'kotlin.checkNotNull' call
          if (tmp0_1 == null) {
            var message_1 = 'Required value was null.';
            throw IllegalStateException().o5(toString(message_1));
          } else {
            tmp$ret$7 = tmp0_1;
            break $l$block_1;
          }
        }
        var tmp_2 = tmp$ret$7;
        var tmp1_elvis_lhs = this.t9a_1;
        var tmp_3 = tmp1_elvis_lhs == null ? false : tmp1_elvis_lhs;
        var tmp2_elvis_lhs = this.u9a_1;
        var tmp_4;
        if (tmp2_elvis_lhs == null) {
          // Inline function 'kotlin.checkNotNull' call
          var tmp0_2 = this.o9a_1;
          var tmp$ret$10;
          $l$block_2: {
            // Inline function 'kotlin.checkNotNull' call
            if (tmp0_2 == null) {
              var message_2 = 'Required value was null.';
              throw IllegalStateException().o5(toString(message_2));
            } else {
              tmp$ret$10 = tmp0_2;
              break $l$block_2;
            }
          }
          // Inline function 'kotlin.collections.associate' call
          var this_0 = tmp$ret$10;
          var capacity = coerceAtLeast(mapCapacity(collectionSizeOrDefault(this_0, 10)), 16);
          // Inline function 'kotlin.collections.associateTo' call
          var destination = LinkedHashMap().tc(capacity);
          var _iterator__ex2g4s = this_0.x();
          while (_iterator__ex2g4s.y()) {
            var element = _iterator__ex2g4s.z();
            // Inline function 'kotlin.collections.plusAssign' call
            var pair = to(element.r8z_1, false);
            destination.t3(pair.ah_1, pair.bh_1);
          }
          tmp_4 = destination;
        } else {
          tmp_4 = tmp2_elvis_lhs;
        }
        var tmp_5 = tmp_4;
        // Inline function 'kotlin.checkNotNull' call
        var tmp0_3 = this.v9a_1;
        var tmp$ret$17;
        $l$block_3: {
          // Inline function 'kotlin.checkNotNull' call
          if (tmp0_3 == null) {
            var message_3 = 'Required value was null.';
            throw IllegalStateException().o5(toString(message_3));
          } else {
            tmp$ret$17 = tmp0_3;
            break $l$block_3;
          }
        }
        var tmp$ret$18 = tmp$ret$17;
        return new (Leaf())(this.l9a_1, this.m9a_1, this.n9a_1, tmp, tmp_0, tmp_1, tmp_2, tmp_3, tmp_5, tmp$ret$18, this.w9a_1);
      }
      x9b(isSubway, context) {
        var tmp0_safe_receiver = this.r9a_1;
        var tmp;
        if (tmp0_safe_receiver == null) {
          tmp = null;
        } else {
          // Inline function 'kotlin.collections.filter' call
          // Inline function 'kotlin.collections.filterTo' call
          var destination = ArrayList().g1();
          var _iterator__ex2g4s = tmp0_safe_receiver.x();
          while (_iterator__ex2g4s.y()) {
            var element = _iterator__ex2g4s.z();
            var tmp_0;
            if (context.equals(Context_NearbyTransit_getInstance_0()) || context.equals(Context_StopDetailsUnfiltered_getInstance_0()) || isSubway) {
              tmp_0 = !element.t21();
            } else {
              tmp_0 = true;
            }
            if (tmp_0) {
              destination.i(element);
            }
          }
          tmp = destination;
        }
        var filteredTrips = tmp;
        this.r9a_1 = filteredTrips;
        return this;
      }
      y9b() {
        var tmp0_safe_receiver = this.r9a_1;
        var tmp;
        if (tmp0_safe_receiver == null) {
          tmp = null;
        } else {
          // Inline function 'kotlin.collections.filterNot' call
          // Inline function 'kotlin.collections.filterNotTo' call
          var destination = ArrayList().g1();
          var _iterator__ex2g4s = tmp0_safe_receiver.x();
          while (_iterator__ex2g4s.y()) {
            var element = _iterator__ex2g4s.z();
            var tmp0_elvis_lhs = element.z9b();
            if (!(tmp0_elvis_lhs == null ? false : tmp0_elvis_lhs)) {
              destination.i(element);
            }
          }
          tmp = destination;
        }
        var filteredTrips = tmp;
        this.r9a_1 = filteredTrips;
        return this;
      }
      w9b(stop, filterAtTime, cutoffTime, showAllPatternsWhileLoading, lineOrRoute, globalData) {
        if (this.t9a_1 === false && showAllPatternsWhileLoading)
          return true;
        var isBus = lineOrRoute.f98().equals(RouteType_BUS_getInstance());
        var isSubway = lineOrRoute.g98();
        var tmp;
        if (cutoffTime == null) {
          var tmp1_safe_receiver = this.r9a_1;
          var tmp_0;
          if (tmp1_safe_receiver == null) {
            tmp_0 = null;
          } else {
            // Inline function 'kotlin.collections.filter' call
            // Inline function 'kotlin.collections.filterTo' call
            var destination = ArrayList().g1();
            var _iterator__ex2g4s = tmp1_safe_receiver.x();
            while (_iterator__ex2g4s.y()) {
              var element = _iterator__ex2g4s.z();
              if (element.a9c()) {
                destination.i(element);
              }
            }
            tmp_0 = destination;
          }
          tmp = tmp_0;
        } else {
          var tmp2_safe_receiver = this.r9a_1;
          var tmp_1;
          if (tmp2_safe_receiver == null) {
            tmp_1 = null;
          } else {
            // Inline function 'kotlin.collections.filter' call
            // Inline function 'kotlin.collections.filterTo' call
            var destination_0 = ArrayList().g1();
            var _iterator__ex2g4s_0 = tmp2_safe_receiver.x();
            while (_iterator__ex2g4s_0.y()) {
              var element_0 = _iterator__ex2g4s_0.z();
              if (element_0.h97(filterAtTime, cutoffTime)) {
                destination_0.i(element_0);
              }
            }
            tmp_1 = destination_0;
          }
          tmp = tmp_1;
        }
        var tmp3_safe_receiver = tmp;
        var upcomingTripsInCutoff = tmp3_safe_receiver == null ? null : take(tmp3_safe_receiver, isBus ? 2 : 3);
        var tmp_2;
        if (upcomingTripsInCutoff == null) {
          tmp_2 = null;
        } else {
          var tmp$ret$6;
          $l$block_0: {
            // Inline function 'kotlin.collections.any' call
            var tmp_3;
            if (isInterface(upcomingTripsInCutoff, Collection())) {
              tmp_3 = upcomingTripsInCutoff.h1();
            } else {
              tmp_3 = false;
            }
            if (tmp_3) {
              tmp$ret$6 = false;
              break $l$block_0;
            }
            var _iterator__ex2g4s_1 = upcomingTripsInCutoff.x();
            while (_iterator__ex2g4s_1.y()) {
              var element_1 = _iterator__ex2g4s_1.z();
              var tmp0_safe_receiver = element_1.v8t_1.s8t_1;
              var tmp_4;
              if (tmp0_safe_receiver == null) {
                tmp_4 = null;
              } else {
                // Inline function 'kotlin.let' call
                var tmp0_safe_receiver_0 = this.p9a_1;
                tmp_4 = tmp0_safe_receiver_0 == null ? null : tmp0_safe_receiver_0.j1(tmp0_safe_receiver);
              }
              var tmp1_elvis_lhs = tmp_4;
              if (tmp1_elvis_lhs == null ? true : tmp1_elvis_lhs) {
                tmp$ret$6 = true;
                break $l$block_0;
              }
            }
            tmp$ret$6 = false;
          }
          tmp_2 = tmp$ret$6;
        }
        var tmp5_elvis_lhs = tmp_2;
        var hasUnseenUpcomingTrip = tmp5_elvis_lhs == null ? false : tmp5_elvis_lhs;
        var tmp_5;
        if (isSubway) {
          var tmp_6;
          if (isTypicalLastStopOnRoutePattern(this, stop, globalData)) {
            var tmp6_safe_receiver = this.r9a_1;
            var tmp7_elvis_lhs = tmp6_safe_receiver == null ? null : isArrivalOnly(tmp6_safe_receiver);
            tmp_6 = tmp7_elvis_lhs == null ? true : tmp7_elvis_lhs;
          } else {
            tmp_6 = false;
          }
          tmp_5 = tmp_6;
        } else {
          var tmp8_safe_receiver = this.r9a_1;
          var tmp9_elvis_lhs = tmp8_safe_receiver == null ? null : isArrivalOnly(tmp8_safe_receiver);
          tmp_5 = tmp9_elvis_lhs == null ? isTypicalLastStopOnRoutePattern(this, stop, globalData) : tmp9_elvis_lhs;
        }
        var shouldBeFilteredAsArrivalOnly = tmp_5;
        var tmp10_safe_receiver = this.o9a_1;
        var tmp_7;
        if (tmp10_safe_receiver == null) {
          tmp_7 = null;
        } else {
          var tmp$ret$10;
          $l$block_2: {
            // Inline function 'kotlin.collections.any' call
            var tmp_8;
            if (isInterface(tmp10_safe_receiver, Collection())) {
              tmp_8 = tmp10_safe_receiver.h1();
            } else {
              tmp_8 = false;
            }
            if (tmp_8) {
              tmp$ret$10 = false;
              break $l$block_2;
            }
            var _iterator__ex2g4s_2 = tmp10_safe_receiver.x();
            while (_iterator__ex2g4s_2.y()) {
              var element_2 = _iterator__ex2g4s_2.z();
              var tmp_9;
              var tmp0_safe_receiver_1 = this.p9a_1;
              var tmp1_elvis_lhs_0 = tmp0_safe_receiver_1 == null ? null : tmp0_safe_receiver_1.j1(element_2.r8z_1);
              if (tmp1_elvis_lhs_0 == null ? false : tmp1_elvis_lhs_0) {
                tmp_9 = element_2.j97();
              } else {
                tmp_9 = false;
              }
              if (tmp_9) {
                tmp$ret$10 = true;
                break $l$block_2;
              }
            }
            tmp$ret$10 = false;
          }
          tmp_7 = tmp$ret$10;
        }
        var tmp11_elvis_lhs = tmp_7;
        var hasUnseenTypicalPattern = tmp11_elvis_lhs == null ? false : tmp11_elvis_lhs;
        return (hasUnseenTypicalPattern || hasUnseenUpcomingTrip) && !shouldBeFilteredAsArrivalOnly;
      }
      toString() {
        return 'LeafBuilder(lineOrRoute=' + toString(this.l9a_1) + ', stop=' + this.m9a_1.toString() + ', directionId=' + this.n9a_1 + ', routePatterns=' + toString_0(this.o9a_1) + ', patternsNotSeenAtEarlierStops=' + toString_0(this.p9a_1) + ', stopIds=' + toString_0(this.q9a_1) + ', upcomingTrips=' + toString_0(this.r9a_1) + ', alertsHere=' + toString_0(this.s9a_1) + ', allDataLoaded=' + this.t9a_1 + ', hasSchedulesTodayByPattern=' + toString_0(this.u9a_1) + ', alertsDownstream=' + toString_0(this.v9a_1) + ', context=' + this.w9a_1.toString() + ')';
      }
      hashCode() {
        var result = hashCode(this.l9a_1);
        result = imul(result, 31) + this.m9a_1.hashCode() | 0;
        result = imul(result, 31) + this.n9a_1 | 0;
        result = imul(result, 31) + (this.o9a_1 == null ? 0 : hashCode(this.o9a_1)) | 0;
        result = imul(result, 31) + (this.p9a_1 == null ? 0 : hashCode(this.p9a_1)) | 0;
        result = imul(result, 31) + (this.q9a_1 == null ? 0 : hashCode(this.q9a_1)) | 0;
        result = imul(result, 31) + (this.r9a_1 == null ? 0 : hashCode(this.r9a_1)) | 0;
        result = imul(result, 31) + (this.s9a_1 == null ? 0 : hashCode(this.s9a_1)) | 0;
        result = imul(result, 31) + (this.t9a_1 == null ? 0 : getBooleanHashCode(this.t9a_1)) | 0;
        result = imul(result, 31) + (this.u9a_1 == null ? 0 : hashCode(this.u9a_1)) | 0;
        result = imul(result, 31) + (this.v9a_1 == null ? 0 : hashCode(this.v9a_1)) | 0;
        result = imul(result, 31) + this.w9a_1.hashCode() | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof LeafBuilder()))
          return false;
        var tmp0_other_with_cast = other instanceof LeafBuilder() ? other : THROW_CCE();
        if (!equals(this.l9a_1, tmp0_other_with_cast.l9a_1))
          return false;
        if (!this.m9a_1.equals(tmp0_other_with_cast.m9a_1))
          return false;
        if (!(this.n9a_1 === tmp0_other_with_cast.n9a_1))
          return false;
        if (!equals(this.o9a_1, tmp0_other_with_cast.o9a_1))
          return false;
        if (!equals(this.p9a_1, tmp0_other_with_cast.p9a_1))
          return false;
        if (!equals(this.q9a_1, tmp0_other_with_cast.q9a_1))
          return false;
        if (!equals(this.r9a_1, tmp0_other_with_cast.r9a_1))
          return false;
        if (!equals(this.s9a_1, tmp0_other_with_cast.s9a_1))
          return false;
        if (!(this.t9a_1 == tmp0_other_with_cast.t9a_1))
          return false;
        if (!equals(this.u9a_1, tmp0_other_with_cast.u9a_1))
          return false;
        if (!equals(this.v9a_1, tmp0_other_with_cast.v9a_1))
          return false;
        if (!this.w9a_1.equals(tmp0_other_with_cast.w9a_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'LeafBuilder');
    LeafBuilderClass = $;
  }
  return LeafBuilderClass;
}
function Context_NearbyTransit_getInstance_0() {
  Context_initEntries();
  return Context_NearbyTransit_instance;
}
function Context_StopDetailsFiltered_getInstance_0() {
  Context_initEntries();
  return Context_StopDetailsFiltered_instance;
}
function Context_StopDetailsUnfiltered_getInstance_0() {
  Context_initEntries();
  return Context_StopDetailsUnfiltered_instance;
}
function Context_Favorites_getInstance() {
  Context_initEntries();
  return Context_Favorites_instance;
}
var RouteCardDataClass;
function RouteCardData() {
  if (RouteCardDataClass === VOID) {
    class $ {
      constructor(lineOrRoute, stopData, at) {
        this.p8s_1 = lineOrRoute;
        this.q8s_1 = stopData;
        this.r8s_1 = at;
        this.s8s_1 = this.p8s_1.d8h();
      }
      y94(position) {
        return first(this.q8s_1).u8s_1.y94(position);
      }
      toString() {
        return '[RouteCardData]';
      }
      hashCode() {
        var result = hashCode(this.p8s_1);
        result = imul(result, 31) + hashCode(this.q8s_1) | 0;
        result = imul(result, 31) + this.r8s_1.hashCode() | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof RouteCardData()))
          return false;
        var tmp0_other_with_cast = other instanceof RouteCardData() ? other : THROW_CCE();
        if (!equals(this.p8s_1, tmp0_other_with_cast.p8s_1))
          return false;
        if (!equals(this.q8s_1, tmp0_other_with_cast.q8s_1))
          return false;
        if (!this.r8s_1.equals(tmp0_other_with_cast.r8s_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'RouteCardData');
    RouteCardDataClass = $;
  }
  return RouteCardDataClass;
}
function hasContext(_this__u8e3s4, context) {
  var tmp$ret$0;
  $l$block_4: {
    // Inline function 'kotlin.collections.any' call
    var tmp;
    if (isInterface(_this__u8e3s4, Collection())) {
      tmp = _this__u8e3s4.h1();
    } else {
      tmp = false;
    }
    if (tmp) {
      tmp$ret$0 = false;
      break $l$block_4;
    }
    var _iterator__ex2g4s = _this__u8e3s4.x();
    while (_iterator__ex2g4s.y()) {
      var element = _iterator__ex2g4s.z();
      var tmp0 = element.q8s_1;
      var tmp$ret$1;
      $l$block_3: {
        // Inline function 'kotlin.collections.any' call
        var tmp_0;
        if (isInterface(tmp0, Collection())) {
          tmp_0 = tmp0.h1();
        } else {
          tmp_0 = false;
        }
        if (tmp_0) {
          tmp$ret$1 = false;
          break $l$block_3;
        }
        var _iterator__ex2g4s_0 = tmp0.x();
        while (_iterator__ex2g4s_0.y()) {
          var element_0 = _iterator__ex2g4s_0.z();
          var tmp0_0 = element_0.w8s_1;
          var tmp$ret$2;
          $l$block_2: {
            // Inline function 'kotlin.collections.any' call
            var tmp_1;
            if (isInterface(tmp0_0, Collection())) {
              tmp_1 = tmp0_0.h1();
            } else {
              tmp_1 = false;
            }
            if (tmp_1) {
              tmp$ret$2 = false;
              break $l$block_2;
            }
            var _iterator__ex2g4s_1 = tmp0_0.x();
            while (_iterator__ex2g4s_1.y()) {
              var element_1 = _iterator__ex2g4s_1.z();
              if (element_1.j8t_1.equals(context)) {
                tmp$ret$2 = true;
                break $l$block_2;
              }
            }
            tmp$ret$2 = false;
          }
          if (tmp$ret$2) {
            tmp$ret$1 = true;
            break $l$block_3;
          }
        }
        tmp$ret$1 = false;
      }
      if (tmp$ret$1) {
        tmp$ret$0 = true;
        break $l$block_4;
      }
    }
    tmp$ret$0 = false;
  }
  return tmp$ret$0;
}
function sort(_this__u8e3s4, distanceFrom, context) {
  return sortedWith(_this__u8e3s4, PatternSorting_instance.z94(distanceFrom, context));
}
function sort_0(_this__u8e3s4, distanceFrom) {
  return sortedWith(_this__u8e3s4, PatternSorting_instance.a95(distanceFrom));
}
function sort_1(_this__u8e3s4) {
  return sortedWith(_this__u8e3s4, PatternSorting_instance.b95());
}
//region block: init
com_mbta_tid_mbta_app_model_RouteCardData_RouteStopData$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData_Leaf$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData_LineOrRoute_Line$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData_LineOrRoute_Route$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData_LineOrRoute$stable = 0;
com_mbta_tid_mbta_app_model_RouteCardData_HierarchyPath$stable = 0;
com_mbta_tid_mbta_app_model_RouteCardData_ListBuilder$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData_Builder$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData_RouteStopDataBuilder$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData_LeafBuilder$stable = 8;
com_mbta_tid_mbta_app_model_RouteCardData$stable = 8;
Companion_instance_1 = new (Companion())();
//endregion
//region block: exports
export {
  Line as Line2j44elebm2qoz,
  Route as Route3cgwfigfgsfyp,
  hasContext as hasContext32ugsqluz8ov3,
  Context_Favorites_getInstance as Context_Favorites_getInstance1fjx6ke9a3gxg,
  Context_StopDetailsFiltered_getInstance_0 as Context_StopDetailsFiltered_getInstance2z0694gxvxvxa,
  Context_StopDetailsUnfiltered_getInstance_0 as Context_StopDetailsUnfiltered_getInstance1clr1vgsxqyd9,
  Companion_instance_1 as Companion_instanceddvekum65zmi,
};
//endregion

//# sourceMappingURL=RouteCardData.mjs.map
