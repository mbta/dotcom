import {
  setOf1u3mizs95ngxo as setOf,
  mapCapacity1h45rc3eh9p2l as mapCapacity,
  listOfvhqybd2zx248 as listOf,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/collectionJs.mjs';
import { plus1ogy4liedzq5j as plus } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/_Sets.mjs';
import {
  THROW_CCE2g6jy02ryeudk as THROW_CCE,
  ensureNotNull1e947j3ixpazm as ensureNotNull,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/hacks.mjs';
import { KtMap140uvy3s5zad8 as KtMap } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Collections.mjs';
import { isInterface3d6p8outrmvmk as isInterface } from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/typeCheckUtils.mjs';
import {
  Companion_getInstance3d66w2y14ekyi as Companion_getInstance,
  Effect_ElevatorClosure_getInstance3h2v6x4tysaq6 as Effect_ElevatorClosure_getInstance,
} from './Alert.mjs';
import { compareValues1n2ayl87ihzfk as compareValues } from '../../../../../../kotlin-kotlin-stdlib/kotlin/comparisons/Comparisons.mjs';
import { VOID3gxj6tk5isa35 as VOID } from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/void.mjs';
import { Unit_instance1fbcbse1fwigr as Unit_instance } from '../../../../../../kotlin-kotlin-stdlib/kotlin/Unit.mjs';
import { LinkedHashMap1zhqxkxv3xnkl as LinkedHashMap } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/LinkedHashMap.mjs';
import { ArrayList3it5z8td81qkl as ArrayList } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/ArrayListJs.mjs';
import {
  emptyList1g2z5xcrvp2zy as emptyList,
  get_lastIndex1yw0x4k50k51w as get_lastIndex,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/CollectionsKt.mjs';
import { collectionSizeOrDefault36dulx8yinfqm as collectionSizeOrDefault } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Iterables.mjs';
import {
  toSet2orjxp16sotqu as toSet,
  first58ocm7j58k3q as first,
  singleo93pzdgfc557 as single,
  sortedWith2csnbbb21k0lg as sortedWith,
  lastOrNull1aq5oz189qoe1 as lastOrNull,
  singleOrNull21olsob387p54 as singleOrNull,
  firstOrNull1982767dljvdy as firstOrNull,
  plus310ted5e4i90h as plus_0,
  minus1djrl64vbav3y as minus,
  drop3na99dw9feawf as drop,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/_Collections.mjs';
import {
  toString1pkumu07cwy4m as toString,
  equals2au1ep9vhcato as equals,
  hashCodeq5arwsb9dgti as hashCode,
  getBooleanHashCode1bbj3u6b3v0a7 as getBooleanHashCode,
  getStringHashCode26igk1bx568vk as getStringHashCode,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/coreRuntime.mjs';
import { IllegalStateExceptionkoljg5n0nrlr as IllegalStateException } from '../../../../../../kotlin-kotlin-stdlib/kotlin/exceptions.mjs';
import {
  emptySetcxexqki71qfa as emptySet,
  setOf45ia9pnfhe90 as setOf_0,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Sets.mjs';
import { Typicality_Typical_getInstance1vjbpi9hmbchb as Typicality_Typical_getInstance } from './RoutePattern.mjs';
import { startsWith26w8qjqapeeq6 as startsWith } from '../../../../../../kotlin-kotlin-stdlib/kotlin/text/stringsCode.mjs';
import { Companion_getInstance2quiddekkvdc7 as Companion_getInstance_0 } from './Stop.mjs';
import {
  initMetadataForClassbxx6q50dy2s7 as initMetadataForClass,
  initMetadataForLambda3af3he42mmnh as initMetadataForLambda,
  initMetadataForCompanion1wyw17z38v6ac as initMetadataForCompanion,
} from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/metadataUtils.mjs';
import { AlertSignificance_Major_getInstance8pdy9s33p31v as AlertSignificance_Major_getInstance } from './AlertSignificance.mjs';
import { Companion_getInstance20mcswkvz9maw as Companion_getInstance_1 } from './MapStopRoute.mjs';
import {
  Disruption3h4mahuvj55iw as Disruption,
  Some1vxe3j1x21foa as Some,
} from './UpcomingFormat.mjs';
import { FunctionAdapter3lcrrz3moet5b as FunctionAdapter } from '../../../../../../kotlin-kotlin-stdlib/kotlin/js/FunctionAdapter.mjs';
import { Comparator2b3maoeh98xtg as Comparator } from '../../../../../../kotlin-kotlin-stdlib/kotlin/ComparatorJs.mjs';
import { CoroutineImpl2sn3kjnwmfr10 as CoroutineImpl } from '../../../../../../kotlin-kotlin-stdlib/kotlin/coroutines/CoroutineImpl.mjs';
import { CoroutineScopefcb5f5dwqcas as CoroutineScope } from '../../../../../../kotlinx-coroutines-core/kotlinx/coroutines/CoroutineScope.mjs';
import {
  StopIds3tadmr5i08nzw as StopIds,
  Schedules27wq07sv4ax5p as Schedules,
} from './response/TripSchedulesResponse.mjs';
import { CurrentStatus_StoppedAt_getInstanceyckhkey9js9v as CurrentStatus_StoppedAt_getInstance } from './Vehicle.mjs';
import { UpcomingTrip3oaamz2dfy19j as UpcomingTrip } from './UpcomingTrip.mjs';
import { Context_TripDetails_getInstance3hzyput33qet6 as Context_TripDetails_getInstance } from './TripInstantDisplay.mjs';
import { toString30pk9tzaqopn as toString_0 } from '../../../../../../kotlin-kotlin-stdlib/kotlin/Library.mjs';
import { Dispatchers_getInstanceitgtkvqfcnx3 as Dispatchers_getInstance } from '../../../../../../kotlinx-coroutines-core/kotlinx/coroutines/Dispatchers.mjs';
import { withContexte657h72vdbqn as withContext } from '../../../../../../kotlinx-coroutines-core/kotlinx/coroutines/Builders.common.mjs';
import { addAll1k27qatfgp3k5 as addAll } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/MutableCollections.mjs';
import { LinkedHashSet2tkztfx86kyx2 as LinkedHashSet } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/LinkedHashSet.mjs';
import { emptyMapr06gerzljqtm as emptyMap } from '../../../../../../kotlin-kotlin-stdlib/kotlin/collections/Maps.mjs';
//region block: imports
var imul = Math.imul;
//endregion
//region block: pre-declaration
//endregion
var com_mbta_tid_mbta_app_model_TripDetailsStopList_Entry$stable;
var com_mbta_tid_mbta_app_model_TripDetailsStopList_TargetSplit$stable;
var com_mbta_tid_mbta_app_model_TripDetailsStopList$stable;
function invoke$getEntry($globalData, fallbackTime, $alertsData, route, $trip, allElevatorAlerts, optionalWorking) {
  var tmp;
  if (optionalWorking == null) {
    return null;
  } else {
    tmp = optionalWorking;
  }
  var working = tmp;
  var tmp1_elvis_lhs = $globalData.n8u_1.j3(working.p9i_1);
  var tmp_0;
  if (tmp1_elvis_lhs == null) {
    return null;
  } else {
    tmp_0 = tmp1_elvis_lhs;
  }
  var stop = tmp_0;
  var parent = stop.d9a($globalData.n8u_1);
  var parentAndChildStopIds = plus(setOf(parent.v8q_1), parent.e8r_1);
  var disruption = getDisruption(Companion_getInstance_2(), working, fallbackTime, $alertsData, route, $trip.o8t_1, $trip.p8t_1);
  var tmp0 = $globalData.n8u_1;
  var tmp2_safe_receiver = working.t9i_1;
  // Inline function 'kotlin.collections.get' call
  var key = tmp2_safe_receiver == null ? null : tmp2_safe_receiver.p95_1;
  var tmp$ret$0 = (isInterface(tmp0, KtMap()) ? tmp0 : THROW_CCE()).j3(key);
  return new (Entry())(stop, working.q9i_1, disruption, working.s9i_1, working.t9i_1, tmp$ret$0, working.u9i_1, getTransferRoutes(Companion_getInstance_2(), working, $globalData), Companion_getInstance().n8z(allElevatorAlerts, parentAndChildStopIds));
}
function TripDetailsStopList$Companion$fromPieces$slambda$lambda(a, b) {
  // Inline function 'kotlin.comparisons.compareValuesBy' call
  var tmp = a.u1();
  var tmp$ret$1 = b.u1();
  return compareValues(tmp, tmp$ret$1);
}
function putSchedule($this, _this__u8e3s4, schedule) {
  var tmp0_safe_receiver = _this__u8e3s4.j3(schedule.h9f_1);
  var tmp1_elvis_lhs = tmp0_safe_receiver == null ? null : tmp0_safe_receiver.v9i(VOID, VOID, VOID, schedule);
  _this__u8e3s4.t3(schedule.h9f_1, tmp1_elvis_lhs == null ? new (WorkingEntry())(schedule.j9f_1, schedule.h9f_1, VOID, schedule) : tmp1_elvis_lhs);
}
function putPrediction($this, _this__u8e3s4, prediction, vehicle) {
  var tmp0_safe_receiver = _this__u8e3s4.j3(prediction.n95_1);
  var tmp1_elvis_lhs = tmp0_safe_receiver == null ? null : tmp0_safe_receiver.v9i(VOID, VOID, VOID, VOID, prediction, vehicle);
  _this__u8e3s4.t3(prediction.n95_1, tmp1_elvis_lhs == null ? new (WorkingEntry())(prediction.p95_1, prediction.n95_1, VOID, VOID, prediction, vehicle) : tmp1_elvis_lhs);
}
function putEmpty($this, _this__u8e3s4, stopId, stopSequence) {
  if (!_this__u8e3s4.h3(stopSequence)) {
    _this__u8e3s4.t3(stopSequence, new (WorkingEntry())(stopId, stopSequence));
  }
}
function deduplicatePredictionsByStopSequence($this, predictions, tripSchedules, globalData) {
  // Inline function 'kotlin.collections.groupBy' call
  // Inline function 'kotlin.collections.groupByTo' call
  var destination = LinkedHashMap().sc();
  var _iterator__ex2g4s = predictions.x();
  while (_iterator__ex2g4s.y()) {
    var element = _iterator__ex2g4s.z();
    var key = element.n95_1;
    // Inline function 'kotlin.collections.getOrPut' call
    var value = destination.j3(key);
    var tmp;
    if (value == null) {
      var answer = ArrayList().g1();
      destination.t3(key, answer);
      tmp = answer;
    } else {
      tmp = value;
    }
    var list = tmp;
    list.i(element);
  }
  // Inline function 'kotlin.collections.mapValues' call
  // Inline function 'kotlin.collections.mapValuesTo' call
  var destination_0 = LinkedHashMap().tc(mapCapacity(destination.c1()));
  // Inline function 'kotlin.collections.associateByTo' call
  var _iterator__ex2g4s_0 = destination.t1().x();
  while (_iterator__ex2g4s_0.y()) {
    var element_0 = _iterator__ex2g4s_0.z();
    var tmp_0 = element_0.u1();
    // Inline function 'kotlin.collections.component1' call
    var stopSequence = element_0.u1();
    // Inline function 'kotlin.collections.component2' call
    var predictions_0 = element_0.v1();
    var tmp_1;
    if (predictions_0.c1() === 1) {
      tmp_1 = single(predictions_0);
    } else {
      // Inline function 'kotlin.collections.orEmpty' call
      var tmp0_elvis_lhs = tripSchedules == null ? null : tripSchedules.w9i(globalData);
      // Inline function 'kotlin.collections.map' call
      var this_0 = tmp0_elvis_lhs == null ? emptyList() : tmp0_elvis_lhs;
      // Inline function 'kotlin.collections.mapTo' call
      var destination_1 = ArrayList().w(collectionSizeOrDefault(this_0, 10));
      var _iterator__ex2g4s_1 = this_0.x();
      while (_iterator__ex2g4s_1.y()) {
        var item = _iterator__ex2g4s_1.z();
        var tmp$ret$9 = item.v8q_1;
        destination_1.i(tmp$ret$9);
      }
      var scheduledStopIds = toSet(destination_1);
      // Inline function 'kotlin.collections.filter' call
      // Inline function 'kotlin.collections.filterTo' call
      var destination_2 = ArrayList().g1();
      var _iterator__ex2g4s_2 = predictions_0.x();
      while (_iterator__ex2g4s_2.y()) {
        var element_1 = _iterator__ex2g4s_2.z();
        if (scheduledStopIds.j1(element_1.p95_1)) {
          destination_2.i(element_1);
        }
      }
      var scheduledPredictions = destination_2;
      // Inline function 'kotlin.check' call
      if (!(scheduledPredictions.c1() === 1)) {
        var message = 'Trip ' + first(predictions_0).q95_1 + ' has duplicate predictions ' + toString(predictions_0) + ' at stop sequence ' + stopSequence;
        throw IllegalStateException().o5(toString(message));
      }
      tmp_1 = single(scheduledPredictions);
    }
    var tmp$ret$17 = tmp_1;
    destination_0.t3(tmp_0, tmp$ret$17);
  }
  // Inline function 'kotlin.collections.sortedBy' call
  var this_1 = destination_0.l3();
  // Inline function 'kotlin.comparisons.compareBy' call
  var tmp_2 = TripDetailsStopList$Companion$deduplicatePredictionsByStopSequence$lambda;
  var tmp$ret$21 = new (sam$kotlin_Comparator$0_0())(tmp_2);
  return sortedWith(this_1, tmp$ret$21);
}
function getTransferRoutes($this, entry, globalData) {
  var tmp0_safe_receiver = entry.t9i_1;
  var tmp1_elvis_lhs = tmp0_safe_receiver == null ? null : tmp0_safe_receiver.o95_1;
  var tmp;
  if (tmp1_elvis_lhs == null) {
    var tmp2_safe_receiver = entry.s9i_1;
    tmp = tmp2_safe_receiver == null ? null : tmp2_safe_receiver.i9f_1;
  } else {
    tmp = tmp1_elvis_lhs;
  }
  return $this.u9c(entry.p9i_1, tmp, globalData);
}
function getFilteredRoutesForStop($this, stopId, globalData) {
  var tmp0_safe_receiver = globalData.k8u_1.j3(stopId);
  var tmp;
  if (tmp0_safe_receiver == null) {
    tmp = null;
  } else {
    // Inline function 'kotlin.collections.map' call
    // Inline function 'kotlin.collections.mapTo' call
    var destination = ArrayList().w(collectionSizeOrDefault(tmp0_safe_receiver, 10));
    var _iterator__ex2g4s = tmp0_safe_receiver.x();
    while (_iterator__ex2g4s.y()) {
      var item = _iterator__ex2g4s.z();
      var tmp$ret$0 = globalData.m8u_1.j3(item);
      destination.i(tmp$ret$0);
    }
    tmp = destination;
  }
  var tmp1_safe_receiver = tmp;
  var tmp_0;
  if (tmp1_safe_receiver == null) {
    tmp_0 = null;
  } else {
    // Inline function 'kotlin.collections.mapNotNull' call
    // Inline function 'kotlin.collections.mapNotNullTo' call
    var destination_0 = ArrayList().g1();
    // Inline function 'kotlin.collections.forEach' call
    var _iterator__ex2g4s_0 = tmp1_safe_receiver.x();
    while (_iterator__ex2g4s_0.y()) {
      var element = _iterator__ex2g4s_0.z();
      var tmp_1;
      if (shouldExclude(Companion_getInstance_2(), element)) {
        tmp_1 = null;
      } else {
        var tmp0 = globalData.l8u_1;
        // Inline function 'kotlin.collections.get' call
        var key = element == null ? null : element.x8z_1;
        tmp_1 = (isInterface(tmp0, KtMap()) ? tmp0 : THROW_CCE()).j3(key);
      }
      var tmp0_safe_receiver_0 = tmp_1;
      if (tmp0_safe_receiver_0 == null)
        null;
      else {
        // Inline function 'kotlin.let' call
        destination_0.i(tmp0_safe_receiver_0);
      }
    }
    tmp_0 = destination_0;
  }
  var tmp2_safe_receiver = tmp_0;
  var tmp3_elvis_lhs = tmp2_safe_receiver == null ? null : toSet(tmp2_safe_receiver);
  return tmp3_elvis_lhs == null ? emptySet() : tmp3_elvis_lhs;
}
function shouldExclude($this, pattern) {
  return pattern == null || !equals(pattern.v8z_1, Typicality_Typical_getInstance()) || $this.t9c_1.j1(pattern.x8z_1) || startsWith(pattern.x8z_1, 'Logan-');
}
var ScheduleStopSequenceAlignerClass;
function ScheduleStopSequenceAligner() {
  if (ScheduleStopSequenceAlignerClass === VOID) {
    class $ {
      constructor(stopIds, predictions, globalData, entries) {
        this.x9i_1 = stopIds;
        this.y9i_1 = predictions;
        this.z9i_1 = globalData;
        this.a9j_1 = entries;
        this.b9j_1 = null;
        this.c9j_1 = null;
        this.d9j_1 = get_lastIndex(this.x9i_1);
        this.e9j_1 = get_lastIndex(this.y9i_1);
        this.f9j_1 = lastOrNull(this.y9i_1);
        this.g9j_1 = 0;
      }
      z26() {
        this.h9j();
        this.i9j();
        this.j9j();
        this.k9j();
        this.l9j();
      }
      h9j() {
        if (!(this.f9j_1 == null)) {
          $l$loop: while (true) {
            var tmp;
            var containsUpper = this.x9i_1.c1() - 1 | 0;
            var containsArg = this.d9j_1;
            if (0 <= containsArg ? containsArg <= containsUpper : false) {
              tmp = !Companion_getInstance_0().a9g(this.x9i_1.e1(this.d9j_1), this.f9j_1.p95_1, this.z9i_1.n8u_1);
            } else {
              tmp = false;
            }
            if (!tmp) {
              break $l$loop;
            }
            this.d9j_1 = this.d9j_1 - 1 | 0;
            this.g9j_1 = this.g9j_1 + 1 | 0;
          }
        }
      }
      i9j() {
        $l$loop_0: while (true) {
          var tmp;
          var containsUpper = this.x9i_1.c1() - 1 | 0;
          var containsArg = this.d9j_1;
          if (0 <= containsArg ? containsArg <= containsUpper : false) {
            var containsUpper_0 = this.y9i_1.c1() - 1 | 0;
            var containsArg_0 = this.e9j_1;
            tmp = 0 <= containsArg_0 ? containsArg_0 <= containsUpper_0 : false;
          } else {
            tmp = false;
          }
          if (!tmp) {
            break $l$loop_0;
          }
          var stopId = this.x9i_1.e1(this.d9j_1);
          var prediction = this.y9i_1.e1(this.e9j_1);
          if (!Companion_getInstance_0().a9g(stopId, prediction.p95_1, this.z9i_1.n8u_1)) {
            this.d9j_1 = this.d9j_1 - 1 | 0;
            continue $l$loop_0;
          }
          var tmp_0 = this;
          var tmp0_safe_receiver = this.b9j_1;
          tmp_0.c9j_1 = tmp0_safe_receiver == null ? null : tmp0_safe_receiver - prediction.n95_1 | 0;
          this.b9j_1 = prediction.n95_1;
          this.d9j_1 = this.d9j_1 - 1 | 0;
          this.e9j_1 = this.e9j_1 - 1 | 0;
        }
      }
      j9j() {
        var tmp = this;
        var tmp0_elvis_lhs = this.b9j_1;
        tmp.b9j_1 = tmp0_elvis_lhs == null ? 1000 : tmp0_elvis_lhs;
        var tmp_0 = this;
        var tmp1_elvis_lhs = this.c9j_1;
        tmp_0.c9j_1 = tmp1_elvis_lhs == null ? 1 : tmp1_elvis_lhs;
      }
      k9j() {
        $l$loop: while (true) {
          var containsUpper = this.x9i_1.c1() - 1 | 0;
          var containsArg = this.d9j_1;
          if (!(0 <= containsArg ? containsArg <= containsUpper : false)) {
            break $l$loop;
          }
          var stopId = this.x9i_1.e1(this.d9j_1);
          this.b9j_1 = ensureNotNull(this.b9j_1) - ensureNotNull(this.c9j_1) | 0;
          putEmpty(Companion_getInstance_2(), this.a9j_1, stopId, ensureNotNull(this.b9j_1));
          this.d9j_1 = this.d9j_1 - 1 | 0;
        }
      }
      l9j() {
        if (!(this.f9j_1 == null) && this.g9j_1 > 0) {
          this.d9j_1 = (get_lastIndex(this.x9i_1) - this.g9j_1 | 0) + 1 | 0;
          this.b9j_1 = this.f9j_1.n95_1;
          $l$loop: while (true) {
            var containsUpper = this.x9i_1.c1() - 1 | 0;
            var containsArg = this.d9j_1;
            if (!(0 <= containsArg ? containsArg <= containsUpper : false)) {
              break $l$loop;
            }
            var stopId = this.x9i_1.e1(this.d9j_1);
            this.b9j_1 = ensureNotNull(this.b9j_1) + ensureNotNull(this.c9j_1) | 0;
            putEmpty(Companion_getInstance_2(), this.a9j_1, stopId, ensureNotNull(this.b9j_1));
            this.d9j_1 = this.d9j_1 + 1 | 0;
          }
        }
      }
    }
    initMetadataForClass($, 'ScheduleStopSequenceAligner');
    ScheduleStopSequenceAlignerClass = $;
  }
  return ScheduleStopSequenceAlignerClass;
}
function getDisruption($this, entry, fallbackTime, alertsData, route, tripId, directionId) {
  var tmp0_elvis_lhs = entry.t9i_1;
  var tmp1_safe_receiver = tmp0_elvis_lhs == null ? entry.s9i_1 : tmp0_elvis_lhs;
  var tmp2_elvis_lhs = tmp1_safe_receiver == null ? null : tmp1_safe_receiver.v95();
  var entryTime = tmp2_elvis_lhs == null ? fallbackTime : tmp2_elvis_lhs;
  var entryRouteType = route == null ? null : route.p8r_1;
  var tmp5_safe_receiver = alertsData == null ? null : alertsData.y91_1;
  var tmp6_safe_receiver = tmp5_safe_receiver == null ? null : tmp5_safe_receiver.l3();
  var tmp;
  if (tmp6_safe_receiver == null) {
    tmp = null;
  } else {
    // Inline function 'kotlin.collections.find' call
    var tmp$ret$3;
    $l$block: {
      // Inline function 'kotlin.collections.firstOrNull' call
      var _iterator__ex2g4s = tmp6_safe_receiver.x();
      while (_iterator__ex2g4s.y()) {
        var element = _iterator__ex2g4s.z();
        var tmp_0;
        var tmp_1;
        var tmp_2;
        if (entryTime == null) {
          tmp_2 = null;
        } else {
          // Inline function 'kotlin.let' call
          tmp_2 = element.c90(entryTime);
        }
        var tmp1_elvis_lhs = tmp_2;
        if (tmp1_elvis_lhs == null ? true : tmp1_elvis_lhs) {
          tmp_1 = element.o8z(TripDetailsStopList$Companion$getDisruption$lambda(directionId, route, entryRouteType, entry, tripId));
        } else {
          tmp_1 = false;
        }
        if (tmp_1) {
          tmp_0 = element.k8z_1.a4(AlertSignificance_Major_getInstance()) >= 0;
        } else {
          tmp_0 = false;
        }
        if (tmp_0) {
          tmp$ret$3 = element;
          break $l$block;
        }
      }
      tmp$ret$3 = null;
    }
    tmp = tmp$ret$3;
  }
  var alert = tmp;
  if (alert == null)
    return null;
  var tmp_3;
  if (route == null) {
    tmp_3 = null;
  } else {
    // Inline function 'kotlin.let' call
    tmp_3 = Companion_getInstance_1().n90(route);
  }
  return Disruption().w97(alert, tmp_3);
}
var sam$kotlin_Comparator$0Class;
function sam$kotlin_Comparator$0() {
  if (sam$kotlin_Comparator$0Class === VOID) {
    class $ {
      constructor(function_0) {
        this.m9j_1 = function_0;
      }
      al(a, b) {
        return this.m9j_1(a, b);
      }
      compare(a, b) {
        return this.al(a, b);
      }
      z4() {
        return this.m9j_1;
      }
      equals(other) {
        var tmp;
        if (!(other == null) ? isInterface(other, Comparator()) : false) {
          var tmp_0;
          if (!(other == null) ? isInterface(other, FunctionAdapter()) : false) {
            tmp_0 = equals(this.z4(), other.z4());
          } else {
            tmp_0 = false;
          }
          tmp = tmp_0;
        } else {
          tmp = false;
        }
        return tmp;
      }
      hashCode() {
        return hashCode(this.z4());
      }
    }
    initMetadataForClass($, 'sam$kotlin_Comparator$0', VOID, VOID, [Comparator(), FunctionAdapter()]);
    sam$kotlin_Comparator$0Class = $;
  }
  return sam$kotlin_Comparator$0Class;
}
var sam$kotlin_Comparator$0Class_0;
function sam$kotlin_Comparator$0_0() {
  if (sam$kotlin_Comparator$0Class_0 === VOID) {
    class $ {
      constructor(function_0) {
        this.n9j_1 = function_0;
      }
      al(a, b) {
        return this.n9j_1(a, b);
      }
      compare(a, b) {
        return this.al(a, b);
      }
      z4() {
        return this.n9j_1;
      }
      equals(other) {
        var tmp;
        if (!(other == null) ? isInterface(other, Comparator()) : false) {
          var tmp_0;
          if (!(other == null) ? isInterface(other, FunctionAdapter()) : false) {
            tmp_0 = equals(this.z4(), other.z4());
          } else {
            tmp_0 = false;
          }
          tmp = tmp_0;
        } else {
          tmp = false;
        }
        return tmp;
      }
      hashCode() {
        return hashCode(this.z4());
      }
    }
    initMetadataForClass($, 'sam$kotlin_Comparator$0', VOID, VOID, [Comparator(), FunctionAdapter()]);
    sam$kotlin_Comparator$0Class_0 = $;
  }
  return sam$kotlin_Comparator$0Class_0;
}
var sam$kotlin_Comparator$0Class_1;
function sam$kotlin_Comparator$0_1() {
  if (sam$kotlin_Comparator$0Class_1 === VOID) {
    class $ {
      constructor(function_0) {
        this.o9j_1 = function_0;
      }
      al(a, b) {
        return this.o9j_1(a, b);
      }
      compare(a, b) {
        return this.al(a, b);
      }
      z4() {
        return this.o9j_1;
      }
      equals(other) {
        var tmp;
        if (!(other == null) ? isInterface(other, Comparator()) : false) {
          var tmp_0;
          if (!(other == null) ? isInterface(other, FunctionAdapter()) : false) {
            tmp_0 = equals(this.z4(), other.z4());
          } else {
            tmp_0 = false;
          }
          tmp = tmp_0;
        } else {
          tmp = false;
        }
        return tmp;
      }
      hashCode() {
        return hashCode(this.z4());
      }
    }
    initMetadataForClass($, 'sam$kotlin_Comparator$0', VOID, VOID, [Comparator(), FunctionAdapter()]);
    sam$kotlin_Comparator$0Class_1 = $;
  }
  return sam$kotlin_Comparator$0Class_1;
}
var TripDetailsStopList$Companion$fromPieces$slambdaClass;
function TripDetailsStopList$Companion$fromPieces$slambda() {
  if (TripDetailsStopList$Companion$fromPieces$slambdaClass === VOID) {
    class $ extends CoroutineImpl() {
      constructor($alertsData, $tripPredictions, $tripSchedules, $globalData, $vehicle, $trip, resultContinuation, $box) {
        if ($box === VOID)
          $box = {};
        $box.x9j_1 = $alertsData;
        $box.y9j_1 = $tripPredictions;
        $box.z9j_1 = $tripSchedules;
        $box.a9k_1 = $globalData;
        $box.b9k_1 = $vehicle;
        $box.c9k_1 = $trip;
        super(resultContinuation, $box);
      }
      e9k($this$withContext, $completion) {
        var tmp = this.y3e($this$withContext, $completion);
        tmp.hd_1 = Unit_instance;
        tmp.id_1 = null;
        return tmp.nd();
      }
      ne(p1, $completion) {
        return this.e9k((!(p1 == null) ? isInterface(p1, CoroutineScope()) : false) ? p1 : THROW_CCE(), $completion);
      }
      nd() {
        var suspendResult = this.hd_1;
        $sm: do
          try {
            var tmp = this.fd_1;
            if (tmp === 0) {
              this.gd_1 = 1;
              if (this.x9j_1 == null)
                return null;
              var entries = LinkedHashMap().sc();
              var tmp0_safe_receiver = this.y9j_1;
              var tmp1_safe_receiver = tmp0_safe_receiver == null ? null : tmp0_safe_receiver.s9b_1;
              var tmp2_safe_receiver = tmp1_safe_receiver == null ? null : tmp1_safe_receiver.l3();
              var tmp3_safe_receiver = tmp2_safe_receiver == null ? null : singleOrNull(tmp2_safe_receiver);
              var tmp4_elvis_lhs = tmp3_safe_receiver == null ? null : tmp3_safe_receiver.r8t_1;
              var tmp_0;
              if (tmp4_elvis_lhs == null) {
                var tmp5_safe_receiver = this.z9j_1;
                tmp_0 = tmp5_safe_receiver == null ? null : tmp5_safe_receiver.f9k();
              } else {
                tmp_0 = tmp4_elvis_lhs;
              }
              var routeId = tmp_0;
              var this_0 = this.a9k_1.l8u_1;
              var route = (isInterface(this_0, KtMap()) ? this_0 : THROW_CCE()).j3(routeId);
              var predictions = emptyList();
              if (!(this.y9j_1 == null)) {
                var tmp0 = this.y9j_1.r9b_1.l3();
                var destination = ArrayList().g1();
                var _iterator__ex2g4s = tmp0.x();
                while (_iterator__ex2g4s.y()) {
                  var element = _iterator__ex2g4s.z();
                  if (routeId == null || element.o95_1 === routeId) {
                    destination.i(element);
                  }
                }
                var tripPredictionsWithCorrectRoute = destination;
                predictions = deduplicatePredictionsByStopSequence(Companion_getInstance_2(), tripPredictionsWithCorrectRoute, this.z9j_1, this.a9k_1);
                var _iterator__ex2g4s_0 = predictions.x();
                while (_iterator__ex2g4s_0.y()) {
                  var element_0 = _iterator__ex2g4s_0.z();
                  putPrediction(Companion_getInstance_2(), entries, element_0, this.b9k_1);
                }
              }
              var tmp_1 = this.z9j_1;
              if (tmp_1 instanceof Schedules()) {
                var _iterator__ex2g4s_1 = this.z9j_1.h9k_1.x();
                while (_iterator__ex2g4s_1.y()) {
                  var element_1 = _iterator__ex2g4s_1.z();
                  putSchedule(Companion_getInstance_2(), entries, element_1);
                }
              } else {
                var tmp_2 = this.z9j_1;
                if (tmp_2 instanceof StopIds()) {
                  var aligner = new (ScheduleStopSequenceAligner())(this.z9j_1.g9k_1, predictions, this.a9k_1, entries);
                  aligner.z26();
                }
              }
              if (entries.h1()) {
                return new (TripDetailsStopList())(this.c9k_1, emptyList());
              }
              var this_1 = entries.t1();
              var tmp_3 = TripDetailsStopList$Companion$fromPieces$slambda$lambda;
              var sortedEntries = sortedWith(this_1, new (sam$kotlin_Comparator$0())(tmp_3));
              var destination_0 = ArrayList().g1();
              var _iterator__ex2g4s_2 = sortedEntries.x();
              while (_iterator__ex2g4s_2.y()) {
                var element_2 = _iterator__ex2g4s_2.z();
                var tmp0_safe_receiver_0 = element_2.v1().t9i_1;
                var tmp1_elvis_lhs = tmp0_safe_receiver_0 == null ? null : tmp0_safe_receiver_0.v95();
                var tmp_4;
                if (tmp1_elvis_lhs == null) {
                  var tmp2_safe_receiver_0 = element_2.v1().s9i_1;
                  tmp_4 = tmp2_safe_receiver_0 == null ? null : tmp2_safe_receiver_0.v95();
                } else {
                  tmp_4 = tmp1_elvis_lhs;
                }
                var tmp0_safe_receiver_1 = tmp_4;
                if (tmp0_safe_receiver_1 == null)
                  null;
                else {
                  destination_0.i(tmp0_safe_receiver_1);
                }
              }
              var fallbackTime = lastOrNull(destination_0);
              var tmp0_0 = this.x9j_1.y91_1.l3();
              var destination_1 = ArrayList().g1();
              var _iterator__ex2g4s_3 = tmp0_0.x();
              while (_iterator__ex2g4s_3.y()) {
                var element_3 = _iterator__ex2g4s_3.z();
                if (element_3.a8z_1.equals(Effect_ElevatorClosure_getInstance())) {
                  destination_1.i(element_3);
                }
              }
              var allElevatorAlerts = destination_1;
              var tmp6_safe_receiver = firstOrNull(sortedEntries);
              var startTerminalEntry = invoke$getEntry(this.a9k_1, fallbackTime, this.x9j_1, route, this.c9k_1, allElevatorAlerts, tmp6_safe_receiver == null ? null : tmp6_safe_receiver.v1());
              var yielding = false;
              var list = ArrayList().g1();
              var _iterator__ex2g4s_4 = sortedEntries.x();
              while (_iterator__ex2g4s_4.y()) {
                var item = _iterator__ex2g4s_4.z();
                if (yielding) {
                  list.i(item);
                } else {
                  var tmp_5;
                  if (this.b9k_1 == null || !(this.b9k_1.t9h_1 === this.c9k_1.o8t_1) || this.b9k_1.m9h_1 == null) {
                    tmp_5 = false;
                  } else {
                    tmp_5 = item.v1().q9i_1 < this.b9k_1.m9h_1 || (item.v1().q9i_1 === this.b9k_1.m9h_1 && this.b9k_1.l9h_1.equals(CurrentStatus_StoppedAt_getInstance()));
                  }
                  if (!tmp_5) {
                    list.i(item);
                    yielding = true;
                  }
                }
              }
              var destination_2 = ArrayList().g1();
              var _iterator__ex2g4s_5 = list.x();
              while (_iterator__ex2g4s_5.y()) {
                var element_4 = _iterator__ex2g4s_5.z();
                var tmp0_safe_receiver_2 = invoke$getEntry(this.a9k_1, fallbackTime, this.x9j_1, route, this.c9k_1, allElevatorAlerts, element_4.v1());
                if (tmp0_safe_receiver_2 == null)
                  null;
                else {
                  destination_2.i(tmp0_safe_receiver_2);
                }
              }
              return new (TripDetailsStopList())(this.c9k_1, destination_2, startTerminalEntry);
            } else if (tmp === 1) {
              throw this.id_1;
            }
          } catch ($p) {
            var e = $p;
            throw e;
          }
         while (true);
      }
      y3e($this$withContext, completion) {
        var i = new (TripDetailsStopList$Companion$fromPieces$slambda())(this.x9j_1, this.y9j_1, this.z9j_1, this.a9k_1, this.b9k_1, this.c9k_1, completion);
        i.d9k_1 = $this$withContext;
        return i;
      }
    }
    initMetadataForLambda($, VOID, VOID, [1]);
    TripDetailsStopList$Companion$fromPieces$slambdaClass = $;
  }
  return TripDetailsStopList$Companion$fromPieces$slambdaClass;
}
function TripDetailsStopList$Companion$fromPieces$slambda_0($alertsData, $tripPredictions, $tripSchedules, $globalData, $vehicle, $trip, resultContinuation) {
  var i = new (TripDetailsStopList$Companion$fromPieces$slambda())($alertsData, $tripPredictions, $tripSchedules, $globalData, $vehicle, $trip, resultContinuation);
  var l = function ($this$withContext, $completion) {
    return i.e9k($this$withContext, $completion);
  };
  l.$arity = 1;
  return l;
}
function TripDetailsStopList$Companion$deduplicatePredictionsByStopSequence$lambda(a, b) {
  // Inline function 'kotlin.comparisons.compareValuesBy' call
  var tmp = a.n95_1;
  var tmp$ret$1 = b.n95_1;
  return compareValues(tmp, tmp$ret$1);
}
function TripDetailsStopList$Companion$getTransferRoutes$lambda(a, b) {
  // Inline function 'kotlin.comparisons.compareValuesBy' call
  var tmp = a.w8r_1;
  var tmp$ret$1 = b.w8r_1;
  return compareValues(tmp, tmp$ret$1);
}
function TripDetailsStopList$Companion$getDisruption$lambda($directionId, $route, $entryRouteType, $entry, $tripId) {
  return function (it) {
    var tmp0_safe_receiver = $route;
    return it.o8y($directionId, VOID, tmp0_safe_receiver == null ? null : tmp0_safe_receiver.o8r_1, $entryRouteType, $entry.p9i_1, $tripId);
  };
}
var EntryClass;
function Entry() {
  if (EntryClass === VOID) {
    class $ {
      constructor(stop, stopSequence, disruption, schedule, prediction, predictionStop, vehicle, routes, elevatorAlerts) {
        var tmp;
        if (predictionStop === VOID) {
          // Inline function 'kotlin.takeIf' call
          var tmp_0;
          if (!(prediction == null)) {
            tmp_0 = stop;
          } else {
            tmp_0 = null;
          }
          tmp = tmp_0;
        } else {
          tmp = predictionStop;
        }
        predictionStop = tmp;
        elevatorAlerts = elevatorAlerts === VOID ? emptyList() : elevatorAlerts;
        this.i9k_1 = stop;
        this.j9k_1 = stopSequence;
        this.k9k_1 = disruption;
        this.l9k_1 = schedule;
        this.m9k_1 = prediction;
        this.n9k_1 = predictionStop;
        this.o9k_1 = vehicle;
        this.p9k_1 = routes;
        this.q9k_1 = elevatorAlerts;
        var tmp_1 = this;
        var tmp_2;
        var tmp0_safe_receiver = this.n9k_1;
        if ((tmp0_safe_receiver == null ? null : tmp0_safe_receiver.k8r_1) === true) {
          tmp_2 = this.n9k_1.b8r_1;
        } else {
          tmp_2 = null;
        }
        tmp_1.r9k_1 = tmp_2;
        var tmp_3 = this;
        var tmp0_safe_receiver_0 = this.k9k_1;
        var tmp1_safe_receiver = tmp0_safe_receiver_0 == null ? null : tmp0_safe_receiver_0.t97_1;
        tmp_3.s9k_1 = (tmp1_safe_receiver == null ? null : tmp1_safe_receiver.l8z_1) === true;
      }
      t9k(trip, now, route) {
        if (!(this.k9k_1 == null)) {
          if (!this.s9k_1) {
            return this.k9k_1;
          }
        }
        var tmp0_elvis_lhs = (new (UpcomingTrip())(trip, this.l9k_1, this.m9k_1, this.n9k_1, this.o9k_1)).u9k(now, route, Context_TripDetails_getInstance());
        var tmp;
        if (tmp0_elvis_lhs == null) {
          return null;
        } else {
          tmp = tmp0_elvis_lhs;
        }
        return Some().m92(tmp, null);
      }
      toString() {
        return 'Entry(stop=' + this.i9k_1.toString() + ', stopSequence=' + this.j9k_1 + ', disruption=' + toString_0(this.k9k_1) + ', schedule=' + toString_0(this.l9k_1) + ', prediction=' + toString_0(this.m9k_1) + ', predictionStop=' + toString_0(this.n9k_1) + ', vehicle=' + toString_0(this.o9k_1) + ', routes=' + toString(this.p9k_1) + ', elevatorAlerts=' + toString(this.q9k_1) + ')';
      }
      hashCode() {
        var result = this.i9k_1.hashCode();
        result = imul(result, 31) + this.j9k_1 | 0;
        result = imul(result, 31) + (this.k9k_1 == null ? 0 : this.k9k_1.hashCode()) | 0;
        result = imul(result, 31) + (this.l9k_1 == null ? 0 : this.l9k_1.hashCode()) | 0;
        result = imul(result, 31) + (this.m9k_1 == null ? 0 : this.m9k_1.hashCode()) | 0;
        result = imul(result, 31) + (this.n9k_1 == null ? 0 : this.n9k_1.hashCode()) | 0;
        result = imul(result, 31) + (this.o9k_1 == null ? 0 : this.o9k_1.hashCode()) | 0;
        result = imul(result, 31) + hashCode(this.p9k_1) | 0;
        result = imul(result, 31) + hashCode(this.q9k_1) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof Entry()))
          return false;
        var tmp0_other_with_cast = other instanceof Entry() ? other : THROW_CCE();
        if (!this.i9k_1.equals(tmp0_other_with_cast.i9k_1))
          return false;
        if (!(this.j9k_1 === tmp0_other_with_cast.j9k_1))
          return false;
        if (!equals(this.k9k_1, tmp0_other_with_cast.k9k_1))
          return false;
        if (!equals(this.l9k_1, tmp0_other_with_cast.l9k_1))
          return false;
        if (!equals(this.m9k_1, tmp0_other_with_cast.m9k_1))
          return false;
        if (!equals(this.n9k_1, tmp0_other_with_cast.n9k_1))
          return false;
        if (!equals(this.o9k_1, tmp0_other_with_cast.o9k_1))
          return false;
        if (!equals(this.p9k_1, tmp0_other_with_cast.p9k_1))
          return false;
        if (!equals(this.q9k_1, tmp0_other_with_cast.q9k_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'Entry');
    EntryClass = $;
  }
  return EntryClass;
}
var TargetSplitClass;
function TargetSplit() {
  if (TargetSplitClass === VOID) {
    class $ {
      constructor(firstStop, collapsedStops, targetStop, followingStops, isTruncatedByLastAlert) {
        firstStop = firstStop === VOID ? null : firstStop;
        isTruncatedByLastAlert = isTruncatedByLastAlert === VOID ? false : isTruncatedByLastAlert;
        this.v9k_1 = firstStop;
        this.w9k_1 = collapsedStops;
        this.x9k_1 = targetStop;
        this.y9k_1 = followingStops;
        this.z9k_1 = isTruncatedByLastAlert;
      }
      toString() {
        return 'TargetSplit(firstStop=' + toString_0(this.v9k_1) + ', collapsedStops=' + toString_0(this.w9k_1) + ', targetStop=' + toString_0(this.x9k_1) + ', followingStops=' + toString(this.y9k_1) + ', isTruncatedByLastAlert=' + this.z9k_1 + ')';
      }
      hashCode() {
        var result = this.v9k_1 == null ? 0 : this.v9k_1.hashCode();
        result = imul(result, 31) + (this.w9k_1 == null ? 0 : hashCode(this.w9k_1)) | 0;
        result = imul(result, 31) + (this.x9k_1 == null ? 0 : this.x9k_1.hashCode()) | 0;
        result = imul(result, 31) + hashCode(this.y9k_1) | 0;
        result = imul(result, 31) + getBooleanHashCode(this.z9k_1) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof TargetSplit()))
          return false;
        var tmp0_other_with_cast = other instanceof TargetSplit() ? other : THROW_CCE();
        if (!equals(this.v9k_1, tmp0_other_with_cast.v9k_1))
          return false;
        if (!equals(this.w9k_1, tmp0_other_with_cast.w9k_1))
          return false;
        if (!equals(this.x9k_1, tmp0_other_with_cast.x9k_1))
          return false;
        if (!equals(this.y9k_1, tmp0_other_with_cast.y9k_1))
          return false;
        if (!(this.z9k_1 === tmp0_other_with_cast.z9k_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'TargetSplit');
    TargetSplitClass = $;
  }
  return TargetSplitClass;
}
var WorkingEntryClass;
function WorkingEntry() {
  if (WorkingEntryClass === VOID) {
    class $ {
      constructor(stopId, stopSequence, alert, schedule, prediction, vehicle) {
        alert = alert === VOID ? null : alert;
        schedule = schedule === VOID ? null : schedule;
        prediction = prediction === VOID ? null : prediction;
        vehicle = vehicle === VOID ? null : vehicle;
        this.p9i_1 = stopId;
        this.q9i_1 = stopSequence;
        this.r9i_1 = alert;
        this.s9i_1 = schedule;
        this.t9i_1 = prediction;
        this.u9i_1 = vehicle;
      }
      a9l(stopId, stopSequence, alert, schedule, prediction, vehicle) {
        return new (WorkingEntry())(stopId, stopSequence, alert, schedule, prediction, vehicle);
      }
      v9i(stopId, stopSequence, alert, schedule, prediction, vehicle, $super) {
        stopId = stopId === VOID ? this.p9i_1 : stopId;
        stopSequence = stopSequence === VOID ? this.q9i_1 : stopSequence;
        alert = alert === VOID ? this.r9i_1 : alert;
        schedule = schedule === VOID ? this.s9i_1 : schedule;
        prediction = prediction === VOID ? this.t9i_1 : prediction;
        vehicle = vehicle === VOID ? this.u9i_1 : vehicle;
        return $super === VOID ? this.a9l(stopId, stopSequence, alert, schedule, prediction, vehicle) : $super.a9l.call(this, stopId, stopSequence, alert, schedule, prediction, vehicle);
      }
      toString() {
        return 'WorkingEntry(stopId=' + this.p9i_1 + ', stopSequence=' + this.q9i_1 + ', alert=' + toString_0(this.r9i_1) + ', schedule=' + toString_0(this.s9i_1) + ', prediction=' + toString_0(this.t9i_1) + ', vehicle=' + toString_0(this.u9i_1) + ')';
      }
      hashCode() {
        var result = getStringHashCode(this.p9i_1);
        result = imul(result, 31) + this.q9i_1 | 0;
        result = imul(result, 31) + (this.r9i_1 == null ? 0 : this.r9i_1.hashCode()) | 0;
        result = imul(result, 31) + (this.s9i_1 == null ? 0 : this.s9i_1.hashCode()) | 0;
        result = imul(result, 31) + (this.t9i_1 == null ? 0 : this.t9i_1.hashCode()) | 0;
        result = imul(result, 31) + (this.u9i_1 == null ? 0 : this.u9i_1.hashCode()) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof WorkingEntry()))
          return false;
        var tmp0_other_with_cast = other instanceof WorkingEntry() ? other : THROW_CCE();
        if (!(this.p9i_1 === tmp0_other_with_cast.p9i_1))
          return false;
        if (!(this.q9i_1 === tmp0_other_with_cast.q9i_1))
          return false;
        if (!equals(this.r9i_1, tmp0_other_with_cast.r9i_1))
          return false;
        if (!equals(this.s9i_1, tmp0_other_with_cast.s9i_1))
          return false;
        if (!equals(this.t9i_1, tmp0_other_with_cast.t9i_1))
          return false;
        if (!equals(this.u9i_1, tmp0_other_with_cast.u9i_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'WorkingEntry');
    WorkingEntryClass = $;
  }
  return WorkingEntryClass;
}
var CompanionClass;
function Companion() {
  if (CompanionClass === VOID) {
    class $ {
      constructor() {
        Companion_instance = this;
        this.t9c_1 = setOf_0(['2427', '3233', '3738', '4050', '725', '8993', '116117', '214216', '441442', '9701', '9702', '9703', 'Boat-F3']);
      }
      b9l(trip, tripSchedules, tripPredictions, vehicle, alertsData, globalData, $completion) {
        var tmp = Dispatchers_getInstance().u28_1;
        return withContext(tmp, TripDetailsStopList$Companion$fromPieces$slambda_0(alertsData, tripPredictions, tripSchedules, globalData, vehicle, trip, null), $completion);
      }
      u9c(stopId, currentRouteId, globalData) {
        var tmp0_elvis_lhs = globalData.n8u_1.j3(stopId);
        var tmp;
        if (tmp0_elvis_lhs == null) {
          return emptyList();
        } else {
          tmp = tmp0_elvis_lhs;
        }
        var stop = tmp;
        var tmp_0;
        if (stop.g8r_1 == null) {
          tmp_0 = stop;
        } else {
          var tmp1_elvis_lhs = globalData.n8u_1.j3(stop.g8r_1);
          var tmp_1;
          if (tmp1_elvis_lhs == null) {
            return emptyList();
          } else {
            tmp_1 = tmp1_elvis_lhs;
          }
          tmp_0 = tmp_1;
        }
        var selfOrParent = tmp_0;
        // Inline function 'kotlin.collections.get' call
        var this_0 = globalData.l8u_1;
        var currentRoute = (isInterface(this_0, KtMap()) ? this_0 : THROW_CCE()).j3(currentRouteId);
        var tmp_2 = plus_0(plus_0(listOf(selfOrParent.v8q_1), selfOrParent.e8r_1), selfOrParent.f8r_1);
        // Inline function 'kotlin.collections.flatMap' call
        var tmp0 = selfOrParent.f8r_1;
        // Inline function 'kotlin.collections.flatMapTo' call
        var destination = ArrayList().g1();
        var _iterator__ex2g4s = tmp0.x();
        while (_iterator__ex2g4s.y()) {
          var element = _iterator__ex2g4s.z();
          var tmp0_safe_receiver = globalData.n8u_1.j3(element);
          var tmp1_elvis_lhs_0 = tmp0_safe_receiver == null ? null : tmp0_safe_receiver.e8r_1;
          var list = tmp1_elvis_lhs_0 == null ? emptyList() : tmp1_elvis_lhs_0;
          addAll(destination, list);
        }
        var transferStopIds = plus_0(tmp_2, destination);
        // Inline function 'kotlin.collections.mutableSetOf' call
        // Inline function 'kotlin.collections.flatMapTo' call
        var destination_0 = LinkedHashSet().f1();
        var _iterator__ex2g4s_0 = transferStopIds.x();
        while (_iterator__ex2g4s_0.y()) {
          var element_0 = _iterator__ex2g4s_0.z();
          var list_0 = getFilteredRoutesForStop(Companion_getInstance_2(), element_0, globalData);
          addAll(destination_0, list_0);
        }
        // Inline function 'kotlin.collections.sortedBy' call
        // Inline function 'kotlin.comparisons.compareBy' call
        var tmp_3 = TripDetailsStopList$Companion$getTransferRoutes$lambda;
        var tmp$ret$7 = new (sam$kotlin_Comparator$0_1())(tmp_3);
        var transferRoutes = sortedWith(destination_0, tmp$ret$7);
        return !(currentRoute == null) ? minus(transferRoutes, currentRoute) : transferRoutes;
      }
    }
    initMetadataForCompanion($, VOID, VOID, [6]);
    CompanionClass = $;
  }
  return CompanionClass;
}
var Companion_instance;
function Companion_getInstance_2() {
  if (Companion_instance === VOID)
    new (Companion())();
  return Companion_instance;
}
var TripDetailsStopListClass;
function TripDetailsStopList() {
  if (TripDetailsStopListClass === VOID) {
    class $ {
      constructor(trip, stops, startTerminalEntry) {
        Companion_getInstance_2();
        startTerminalEntry = startTerminalEntry === VOID ? null : startTerminalEntry;
        this.c9l_1 = trip;
        this.d9l_1 = stops;
        this.e9l_1 = startTerminalEntry;
      }
      f9l(targetStopId, targetStopSequence, globalData) {
        var tmp0 = this.d9l_1;
        var tmp$ret$2;
        $l$block: {
          // Inline function 'kotlin.collections.indexOfFirst' call
          var index = 0;
          var _iterator__ex2g4s = tmp0.x();
          while (_iterator__ex2g4s.y()) {
            var item = _iterator__ex2g4s.z();
            var tmp;
            var tmp_0 = Companion_getInstance_0();
            // Inline function 'kotlin.collections.orEmpty' call
            var tmp0_elvis_lhs = globalData == null ? null : globalData.n8u_1;
            var tmp$ret$0 = tmp0_elvis_lhs == null ? emptyMap() : tmp0_elvis_lhs;
            if (tmp_0.a9g(targetStopId, item.i9k_1.v8q_1, tmp$ret$0)) {
              tmp = item.j9k_1 === targetStopSequence;
            } else {
              tmp = false;
            }
            if (tmp) {
              tmp$ret$2 = index;
              break $l$block;
            }
            index = index + 1 | 0;
          }
          tmp$ret$2 = -1;
        }
        // Inline function 'kotlin.takeUnless' call
        var this_0 = tmp$ret$2;
        var tmp_1;
        if (!(this_0 === -1)) {
          tmp_1 = this_0;
        } else {
          tmp_1 = null;
        }
        var tmp0_elvis_lhs_0 = tmp_1;
        var tmp_2;
        if (tmp0_elvis_lhs_0 == null) {
          var tmp0_0 = this.d9l_1;
          var tmp$ret$7;
          $l$block_0: {
            // Inline function 'kotlin.collections.indexOfLast' call
            var iterator = tmp0_0.k1(tmp0_0.c1());
            while (iterator.j7()) {
              var it = iterator.l7();
              var tmp_3 = Companion_getInstance_0();
              // Inline function 'kotlin.collections.orEmpty' call
              var tmp0_elvis_lhs_1 = globalData == null ? null : globalData.n8u_1;
              var tmp$ret$5 = tmp0_elvis_lhs_1 == null ? emptyMap() : tmp0_elvis_lhs_1;
              if (tmp_3.a9g(targetStopId, it.i9k_1.v8q_1, tmp$ret$5)) {
                tmp$ret$7 = iterator.k7();
                break $l$block_0;
              }
            }
            tmp$ret$7 = -1;
          }
          // Inline function 'kotlin.takeUnless' call
          var this_1 = tmp$ret$7;
          var tmp_4;
          if (!(this_1 === -1)) {
            tmp_4 = this_1;
          } else {
            tmp_4 = null;
          }
          tmp_2 = tmp_4;
        } else {
          tmp_2 = tmp0_elvis_lhs_0;
        }
        var targetStopIndex = tmp_2;
        var firstStop = null;
        var collapsedStops = !(targetStopIndex == null) ? this.d9l_1.g3(0, targetStopIndex) : null;
        var tmp1_safe_receiver = collapsedStops;
        var firstCollapsed = tmp1_safe_receiver == null ? null : firstOrNull(tmp1_safe_receiver);
        var tmp_5;
        if (equals(firstCollapsed, this.e9l_1)) {
          var tmp_6;
          if ((firstCollapsed == null ? null : firstCollapsed.o9k_1) == null) {
            tmp_6 = true;
          } else {
            tmp_6 = !(firstCollapsed.o9k_1.t9h_1 === this.c9l_1.o8t_1);
          }
          tmp_5 = tmp_6;
        } else {
          tmp_5 = false;
        }
        if (tmp_5) {
          var tmp2_safe_receiver = collapsedStops;
          collapsedStops = tmp2_safe_receiver == null ? null : drop(tmp2_safe_receiver, 1);
          firstStop = firstCollapsed;
        }
        var tmp_7;
        if (targetStopIndex == null) {
          tmp_7 = null;
        } else {
          // Inline function 'kotlin.let' call
          tmp_7 = this.d9l_1.e1(targetStopIndex);
        }
        var targetStop = tmp_7;
        var followingStops = !(targetStopIndex == null) ? this.d9l_1.g3(targetStopIndex + 1 | 0, get_lastIndex(this.d9l_1) + 1 | 0) : this.d9l_1;
        var tmp$ret$13;
        $l$block_1: {
          // Inline function 'kotlin.collections.indexOfFirst' call
          var index_0 = 0;
          var _iterator__ex2g4s_0 = followingStops.x();
          while (_iterator__ex2g4s_0.y()) {
            var item_0 = _iterator__ex2g4s_0.z();
            if (item_0.s9k_1) {
              tmp$ret$13 = index_0;
              break $l$block_1;
            }
            index_0 = index_0 + 1 | 0;
          }
          tmp$ret$13 = -1;
        }
        // Inline function 'kotlin.takeUnless' call
        var this_2 = tmp$ret$13;
        var tmp_8;
        if (!(this_2 === -1 || this_2 === get_lastIndex(followingStops))) {
          tmp_8 = this_2;
        } else {
          tmp_8 = null;
        }
        var truncatedStopIndex = tmp_8;
        var isTruncated = !(truncatedStopIndex == null);
        var truncatedFollowingStops = !(truncatedStopIndex == null) ? followingStops.g3(0, truncatedStopIndex + 1 | 0) : followingStops;
        return new (TargetSplit())(firstStop, collapsedStops, targetStop, truncatedFollowingStops, isTruncated);
      }
      toString() {
        return '[TripDetailsStopList]';
      }
      hashCode() {
        var result = this.c9l_1.hashCode();
        result = imul(result, 31) + hashCode(this.d9l_1) | 0;
        result = imul(result, 31) + (this.e9l_1 == null ? 0 : this.e9l_1.hashCode()) | 0;
        return result;
      }
      equals(other) {
        if (this === other)
          return true;
        if (!(other instanceof TripDetailsStopList()))
          return false;
        var tmp0_other_with_cast = other instanceof TripDetailsStopList() ? other : THROW_CCE();
        if (!this.c9l_1.equals(tmp0_other_with_cast.c9l_1))
          return false;
        if (!equals(this.d9l_1, tmp0_other_with_cast.d9l_1))
          return false;
        if (!equals(this.e9l_1, tmp0_other_with_cast.e9l_1))
          return false;
        return true;
      }
    }
    initMetadataForClass($, 'TripDetailsStopList');
    TripDetailsStopListClass = $;
  }
  return TripDetailsStopListClass;
}
//region block: init
com_mbta_tid_mbta_app_model_TripDetailsStopList_Entry$stable = 8;
com_mbta_tid_mbta_app_model_TripDetailsStopList_TargetSplit$stable = 8;
com_mbta_tid_mbta_app_model_TripDetailsStopList$stable = 8;
//endregion
//region block: exports
export {
  Companion_getInstance_2 as Companion_getInstance1tlsnvk3i2534,
};
//endregion

//# sourceMappingURL=TripDetailsStopList.mjs.map
